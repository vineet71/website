import{Clock as e,PerspectiveCamera as t,Scene as i,WebGLRenderer as s,SRGBColorSpace as n,MathUtils as o,Vector2 as r,Color as a,InstancedMesh as c,PlaneGeometry as h,MeshBasicMaterial as l,AdditiveBlending as d,Object3D as u,Vector3 as p,TextureLoader as m,MeshPhysicalMaterial as f,ShaderChunk as g,FrontSide as v,PointLight as y,LatheGeometry as x,PCFSoftShadowMap as w,Raycaster as z,Plane as S,InstancedBufferAttribute as P,Mesh as b,WebGLRenderTarget as M,RGBAFormat as C,FloatType as A,ShaderMaterial as R,Uniform as D,EquirectangularReflectionMapping as E,CatmullRomCurve3 as I,OrthographicCamera as O,PMREMGenerator as L,SphereGeometry as F,AmbientLight as T,ACESFilmicToneMapping as U,DirectionalLight as k,BufferGeometry as _,Float32BufferAttribute as N,PointsMaterial as j,Points as B,SplineCurve as V,HalfFloatType as q}from"three";import{OrbitControls as Z}from"three/examples/jsm/controls/OrbitControls.js";import{EffectComposer as W,RenderPass as H,DepthOfFieldEffect as Y,EffectPass as G,BloomEffect as X}from"postprocessing";import"three/examples/jsm/loaders/GLTFLoader.js";import"three/examples/jsm/loaders/DRACOLoader.js";import{RGBELoader as Q}from"three/examples/jsm/loaders/RGBELoader.js";import{FullScreenQuad as $}from"three/examples/jsm/postprocessing/Pass.js";import{RoomEnvironment as J}from"three/examples/jsm/environments/RoomEnvironment.js";import{EffectComposer as K}from"three/examples/jsm/postprocessing/EffectComposer.js";import{RenderPass as ee}from"three/examples/jsm/postprocessing/RenderPass.js";import{UnrealBloomPass as te}from"three/examples/jsm/postprocessing/UnrealBloomPass.js";import{ShaderPass as ie}from"three/examples/jsm/postprocessing/ShaderPass.js";import{OutputPass as se}from"three/examples/jsm/postprocessing/OutputPass.js";import{GPUComputationRenderer as ne}from"three/examples/jsm/misc/GPUComputationRenderer.js";import{Clock as oe,PerspectiveCamera as re,Scene as ae,WebGPURenderer as ce,MathUtils as he,Mesh as le,Vector3 as de,TubeGeometry as ue,CatmullRomCurve3 as pe,PointLight as me,MeshStandardMaterial as fe,PostProcessing as ge,Raycaster as ve,Plane as ye}from"three/webgpu";import{pass as xe}from"three/tsl";import{bloom as we}from"three/addons/tsl/display/BloomNode.js";let ze=class{#e;canvas;camera;cameraMinAspect;cameraMaxAspect;cameraFov;maxPixelRatio;minPixelRatio;scene;renderer;#t;size={width:0,height:0,wWidth:0,wHeight:0,ratio:0,pixelRatio:0};render=this.#i;onBeforeRender=()=>{};onAfterRender=()=>{};onAfterResize=()=>{};#s=!1;#n=!1;isDisposed=!1;#o;#r;#a;#c=new e;#h={elapsed:0,delta:0};#l;constructor(e){this.#e={...e},this.#d(),this.#u(),this.#p(),this.resize(),this.#m()}#d(){this.camera=new t,this.cameraFov=this.camera.fov}#u(){this.scene=new i}#p(){this.#e.canvas?this.canvas=this.#e.canvas:this.#e.id?this.canvas=document.getElementById(this.#e.id):console.error("Three: Missing canvas or id parameter"),this.canvas.style.display="block";const e={canvas:this.canvas,powerPreference:"high-performance",...this.#e.rendererOptions??{}};this.renderer=new s(e),this.renderer.outputColorSpace=n}#m(){this.#e.size instanceof Object||(window.addEventListener("resize",this.#f.bind(this)),"parent"===this.#e.size&&(this.#r=new ResizeObserver(this.#f.bind(this)),this.#r.observe(this.canvas.parentNode))),this.#o=new IntersectionObserver(this.#g.bind(this),{root:null,rootMargin:"0px",threshold:0}),this.#o.observe(this.canvas),document.addEventListener("visibilitychange",this.#v.bind(this))}#y(){window.removeEventListener("resize",this.#f.bind(this)),this.#r?.disconnect(),this.#o?.disconnect(),document.removeEventListener("visibilitychange",this.#v.bind(this))}#g(e){this.#s=e[0].isIntersecting,this.#s?this.#x():this.#w()}#v(e){this.#s&&(document.hidden?this.#w():this.#x())}#f(){this.#a&&clearTimeout(this.#a),this.#a=setTimeout(this.resize.bind(this),100)}resize(){let e,t;this.#e.size instanceof Object?(e=this.#e.size.width,t=this.#e.size.height):"parent"===this.#e.size&&this.canvas.parentNode?(e=this.canvas.parentNode.offsetWidth,t=this.canvas.parentNode.offsetHeight):(e=window.innerWidth,t=window.innerHeight),this.size.width=e,this.size.height=t,this.size.ratio=e/t,this.#z(),this.#S(),this.onAfterResize(this.size)}#z(){this.camera.aspect=this.size.width/this.size.height,this.camera.isPerspectiveCamera&&this.cameraFov&&(this.cameraMinAspect&&this.camera.aspect<this.cameraMinAspect?this.#P(this.cameraMinAspect):this.cameraMaxAspect&&this.camera.aspect>this.cameraMaxAspect?this.#P(this.cameraMaxAspect):this.camera.fov=this.cameraFov),this.camera.updateProjectionMatrix(),this.updateWorldSize()}#P(e){const t=Math.tan(o.degToRad(this.cameraFov/2))/(this.camera.aspect/e);this.camera.fov=2*o.radToDeg(Math.atan(t))}updateWorldSize(){if(this.camera.isPerspectiveCamera){const e=this.camera.fov*Math.PI/180;this.size.wHeight=2*Math.tan(e/2)*this.camera.position.length(),this.size.wWidth=this.size.wHeight*this.camera.aspect}else this.camera.isOrthographicCamera&&(this.size.wHeight=this.camera.top-this.camera.bottom,this.size.wWidth=this.camera.right-this.camera.left)}#S(){this.renderer.setSize(this.size.width,this.size.height),this.#t?.setSize(this.size.width,this.size.height);let e=window.devicePixelRatio;this.maxPixelRatio&&e>this.maxPixelRatio?e=this.maxPixelRatio:this.minPixelRatio&&e<this.minPixelRatio&&(e=this.minPixelRatio),this.renderer.setPixelRatio(e),this.size.pixelRatio=e}get postprocessing(){return this.#t}set postprocessing(e){this.#t=e,this.render=e.render.bind(e)}#x(){if(this.#n)return;console.log("Start rendering");const e=()=>{this.#l=requestAnimationFrame(e),this.#h.delta=this.#c.getDelta(),this.#h.elapsed+=this.#h.delta,this.onBeforeRender(this.#h),this.render(),this.onAfterRender(this.#h)};this.#n=!0,this.#c.start(),e()}#w(){this.#n&&(console.log("Stop rendering"),cancelAnimationFrame(this.#l),this.#n=!1,this.#c.stop())}#i(){this.renderer.render(this.scene,this.camera)}clear(){this.scene.traverse(e=>{e.isMesh&&"object"==typeof e.material&&(Object.keys(e.material).forEach(t=>{const i=e.material[t];null!==i&&"object"==typeof i&&"function"==typeof i.dispose&&i.dispose()}),e.material.dispose(),e.geometry.dispose())}),this.scene.clear()}dispose(){console.log("dispose"),this.#y(),this.#w(),this.clear(),this.#t?.dispose(),this.renderer.dispose(),this.isDisposed=!0}};const Se=new Map,Pe=new r;let be=!1;function Me(e){const t={position:new r,nPosition:new r,hover:!1,onEnter(){},onMove(){},onClick(){},onLeave(){},...e};return function(e,t){Se.has(e)||(Se.set(e,t),be||(document.body.addEventListener("pointermove",Ce),document.body.addEventListener("pointerleave",Re),document.body.addEventListener("click",Ae),be=!0))}(e.domElement,t),t.dispose=()=>{var t;t=e.domElement,Se.delete(t),0===Se.size&&(document.body.removeEventListener("pointermove",Ce),document.body.removeEventListener("pointerleave",Re),be=!1)},t}function Ce(e){Pe.x=e.clientX,Pe.y=e.clientY;for(const[e,t]of Se){const i=e.getBoundingClientRect();Ee(i)?(De(t,i),t.hover||(t.hover=!0,t.onEnter(t)),t.onMove(t)):t.hover&&(t.hover=!1,t.onLeave(t))}}function Ae(e){Pe.x=e.clientX,Pe.y=e.clientY;for(const[e,t]of Se){const i=e.getBoundingClientRect();De(t,i),Ee(i)&&t.onClick(t)}}function Re(){for(const e of Se.values())e.hover&&(e.hover=!1,e.onLeave(e))}function De(e,t){const{position:i,nPosition:s}=e;i.x=Pe.x-t.left,i.y=Pe.y-t.top,s.x=i.x/t.width*2-1,s.y=-i.y/t.height*2+1}function Ee(e){const{x:t,y:i}=Pe,{left:s,top:n,width:o,height:r}=e;return t>=s&&t<=s+o&&i>=n&&i<=n+r}function Ie(e){let t,i;return s(e),{setColors:s,getColorAt:function(e,s=new a){const n=Math.max(0,Math.min(1,e))*(t.length-1),o=Math.floor(n),r=i[o];if(o>=t.length-1)return r.clone();const c=n-o,h=i[o+1];return s.r=r.r+c*(h.r-r.r),s.g=r.g+c*(h.g-r.g),s.b=r.b+c*(h.b-r.b),s}};function s(e){t=e,i=[],t.forEach(e=>{const t=new a(e);i.push(t)})}}var Oe="vec4 permute(vec4 x){vec4 xm=mod(x,289.0);return mod(((xm*34.0)+10.0)*xm,289.0);}float psrdnoise(vec3 x,vec3 period,float alpha,out vec3 gradient){\n#ifndef PERLINGRID\nconst mat3 M=mat3(0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0);const mat3 Mi=mat3(-0.5,0.5,0.5,0.5,-0.5,0.5,0.5,0.5,-0.5);\n#endif\nvec3 uvw;\n#ifndef PERLINGRID\nuvw=M*x;\n#else\nuvw=x+dot(x,vec3(1.0/3.0));\n#endif\nvec3 i0=floor(uvw);vec3 f0=fract(uvw);vec3 g_=step(f0.xyx,f0.yzz);vec3 l_=1.0-g_;vec3 g=vec3(l_.z,g_.xy);vec3 l=vec3(l_.xy,g_.z);vec3 o1=min(g,l);vec3 o2=max(g,l);vec3 i1=i0+o1;vec3 i2=i0+o2;vec3 i3=i0+vec3(1.0);vec3 v0,v1,v2,v3;\n#ifndef PERLINGRID\nv0=Mi*i0;v1=Mi*i1;v2=Mi*i2;v3=Mi*i3;\n#else\nv0=i0-dot(i0,vec3(1.0/6.0));v1=i1-dot(i1,vec3(1.0/6.0));v2=i2-dot(i2,vec3(1.0/6.0));v3=i3-dot(i3,vec3(1.0/6.0));\n#endif\nvec3 x0=x-v0;vec3 x1=x-v1;vec3 x2=x-v2;vec3 x3=x-v3;if(any(greaterThan(period,vec3(0.0)))){vec4 vx=vec4(v0.x,v1.x,v2.x,v3.x);vec4 vy=vec4(v0.y,v1.y,v2.y,v3.y);vec4 vz=vec4(v0.z,v1.z,v2.z,v3.z);if(period.x>0.0)vx=mod(vx,period.x);if(period.y>0.0)vy=mod(vy,period.y);if(period.z>0.0)vz=mod(vz,period.z);\n#ifndef PERLINGRID\ni0=M*vec3(vx.x,vy.x,vz.x);i1=M*vec3(vx.y,vy.y,vz.y);i2=M*vec3(vx.z,vy.z,vz.z);i3=M*vec3(vx.w,vy.w,vz.w);\n#else\nv0=vec3(vx.x,vy.x,vz.x);v1=vec3(vx.y,vy.y,vz.y);v2=vec3(vx.z,vy.z,vz.z);v3=vec3(vx.w,vy.w,vz.w);i0=v0+dot(v0,vec3(1.0/3.0));i1=v1+dot(v1,vec3(1.0/3.0));i2=v2+dot(v2,vec3(1.0/3.0));i3=v3+dot(v3,vec3(1.0/3.0));\n#endif\ni0=floor(i0+0.5);i1=floor(i1+0.5);i2=floor(i2+0.5);i3=floor(i3+0.5);}vec4 hash=permute(permute(permute(vec4(i0.z,i1.z,i2.z,i3.z))+vec4(i0.y,i1.y,i2.y,i3.y))+vec4(i0.x,i1.x,i2.x,i3.x));vec4 theta=hash*3.883222077;vec4 sz=hash*-0.006920415+0.996539792;vec4 psi=hash*0.108705628;vec4 Ct=cos(theta);vec4 St=sin(theta);vec4 sz_prime=sqrt(1.0-sz*sz);vec4 gx,gy,gz;\n#ifdef FASTROTATION\nvec4 qx=St;vec4 qy=-Ct;vec4 qz=vec4(0.0);vec4 px=sz*qy;vec4 py=-sz*qx;vec4 pz=sz_prime;psi+=alpha;vec4 Sa=sin(psi);vec4 Ca=cos(psi);gx=Ca*px+Sa*qx;gy=Ca*py+Sa*qy;gz=Ca*pz+Sa*qz;\n#else\nif(alpha!=0.0){vec4 Sp=sin(psi);vec4 Cp=cos(psi);vec4 px=Ct*sz_prime;vec4 py=St*sz_prime;vec4 pz=sz;vec4 Ctp=St*Sp-Ct*Cp;vec4 qx=mix(Ctp*St,Sp,sz);vec4 qy=mix(-Ctp*Ct,Cp,sz);vec4 qz=-(py*Cp+px*Sp);vec4 Sa=vec4(sin(alpha));vec4 Ca=vec4(cos(alpha));gx=Ca*px+Sa*qx;gy=Ca*py+Sa*qy;gz=Ca*pz+Sa*qz;}else{gx=Ct*sz_prime;gy=St*sz_prime;gz=sz;}\n#endif\nvec3 g0=vec3(gx.x,gy.x,gz.x);vec3 g1=vec3(gx.y,gy.y,gz.y);vec3 g2=vec3(gx.z,gy.z,gz.z);vec3 g3=vec3(gx.w,gy.w,gz.w);vec4 w=0.5-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3));w=max(w,0.0);vec4 w2=w*w;vec4 w3=w2*w;vec4 gdotx=vec4(dot(g0,x0),dot(g1,x1),dot(g2,x2),dot(g3,x3));float n=dot(w3,gdotx);vec4 dw=-6.0*w2*gdotx;vec3 dn0=w3.x*g0+dw.x*x0;vec3 dn1=w3.y*g1+dw.y*x1;vec3 dn2=w3.z*g2+dw.z*x2;vec3 dn3=w3.w*g3+dw.w*x3;gradient=39.5*(dn0+dn1+dn2+dn3);return 39.5*n;}";const{randFloatSpread:Le}=o,Fe={count:1024,size:.5,colors:[0]};class Te extends c{constructor(e){const t={...Fe,...e},i=new h(t.size,t.size),s=new l({blending:d,opacity:.5,depthWrite:!1}),n={uRatio:{value:new r(1,1)},uBlurLevel:{value:4},uFocalLength:{value:1},uFocusDistance:{value:1},uMinScale:{value:.1},uMaxScale:{value:1.4},uTime:{value:0},uTimeScale:{value:1},uNoiseCoordScale:{value:3},uNoiseDisplacementScale:{value:.005}};s.onBeforeCompile=e=>{Object.assign(e.uniforms,n),e.vertexShader=`\n        ${Oe}\n        uniform vec2 uRatio;\n        uniform float uFocalLength;\n        uniform float uFocusDistance;\n        uniform float uMinScale;\n        uniform float uMaxScale;\n        uniform float uTime;\n        uniform float uNoiseCoordScale;\n        uniform float uNoiseDisplacementScale;\n        varying float vBokeh;\n      `+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","vec4 mvPosition=vec4(0.0,0.0,0.0,1.0);mvPosition=instanceMatrix*mvPosition;vec3 grad;psrdnoise(mvPosition.xyz*uNoiseCoordScale,vec3(0),uTime*0.5,grad);grad*=uNoiseCoordScale;mvPosition.xyz+=grad*uNoiseDisplacementScale;float d=length(mvPosition.xyz-cameraPosition);vBokeh=smoothstep(0.0,uFocalLength,abs(d-uFocusDistance));float scale=uMinScale+uMaxScale*vBokeh;mvPosition=modelViewMatrix*mvPosition;gl_Position=projectionMatrix*mvPosition;gl_Position.xy+=transformed.xy*uRatio*scale*instanceMatrix[0][0];"),e.fragmentShader="\n        uniform float uBlurLevel;\n        varying float vBokeh;\n      "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","#ifdef USE_MAP\nvec2 uv=vMapUv;uv.y/=8.0;float blurLevel=uBlurLevel*vBokeh;float uvY=floor(blurLevel);float uvYFract=fract(blurLevel);uv.y+=0.125*uvY;vec4 tex1=texture2D(map,uv);uv.y+=0.125;vec4 tex2=texture2D(map,uv);vec4 sampledDiffuseColor=mix(tex1,tex2,uvYFract);diffuseColor*=sampledDiffuseColor;\n#else\ndiffuseColor.a=0.0;\n#endif\n")},super(i,s,t.count),this.config=t,this.uniforms=n,this.dummyO=new u,this.#b()}#b(){for(let e=0;e<this.count;e++)this.dummyO.position.set(Le(2),Le(2),Le(1.7)),this.dummyO.scale.set(1,1,1).multiplyScalar(o.randFloat(.5,1)),this.dummyO.updateMatrix(),this.setMatrixAt(e,this.dummyO.matrix);this.#M()}#M(){const e=Ie(this.config.colors);for(let t=0;t<this.count;t++)this.setColorAt(t,e.getColorAt(Math.random()));this.instanceColor.needsUpdate=!0}setColors(e){this.config.colors=e,this.#M()}update(e){this.uniforms.uTime.value+=e.delta*this.uniforms.uTimeScale.value}setSize(e,t){e>t?this.uniforms.uRatio.value.set(1,e/t):this.uniforms.uRatio.value.set(t/e,1)}}function Ue(e,t={}){const i=new ze({canvas:e,size:"parent"});i.cameraMaxAspect=1.7,i.camera.position.z=1,i.updateWorldSize();const s=new Te;s.setSize(i.size.width,i.size.height),i.scene.add(s);const n=new p,o=Me({domElement:e});o.onMove=()=>{n.x=.1*-o.nPosition.x,n.y=.1*-o.nPosition.y},i.onBeforeRender=e=>{s.position.lerp(n,.05),s.update(e)},i.onAfterResize=e=>{s.setSize(e.width,e.height)};const r=new m;return{three:i,particles:s,loadMap:function(e){r.load(e,e=>{e.flipY=!1,s.material.map=e,s.material.needsUpdate=!0})},setBackgroundColor(e){i.scene.background=new a(e)},setColors:s.setColors.bind(s),dispose(){o.dispose(),i.dispose()}}}class ke extends f{constructor(e){super(e);this.uniforms={thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}},this.defines.USE_UV="",this.onBeforeCompile=e=>{Object.assign(e.uniforms,this.uniforms),e.fragmentShader="\n        uniform float thicknessPower;\n        uniform float thicknessScale;\n        uniform float thicknessDistortion;\n        uniform float thicknessAmbient;\n        uniform float thicknessAttenuation;\n      "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("void main() {","\n        void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, inout ReflectedLight reflectedLight) {\n          vec3 scatteringHalf = normalize(directLight.direction + (geometryNormal * thicknessDistortion));\n          float scatteringDot = pow(saturate(dot(geometryViewDir, -scatteringHalf)), thicknessPower) * thicknessScale;\n          #ifdef USE_COLOR\n            vec3 scatteringIllu = (scatteringDot + thicknessAmbient) * vColor;\n          #else\n            vec3 scatteringIllu = (scatteringDot + thicknessAmbient) * diffuse;\n          #endif\n          reflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;\n        }\n\n        void main() {\n      ");const t=g.lights_fragment_begin.replaceAll("RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );","\n          RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n          RE_Direct_Scattering(directLight, vUv, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, reflectedLight);\n        ");e.fragmentShader=e.fragmentShader.replace("#include <lights_fragment_begin>",t),this.onBeforeCompile2&&this.onBeforeCompile2(e)}}}const{randFloatSpread:_e,smoothstep:Ne}=o,je={type:"hexagon",n:20,padding:0,light1Color:16777215,light1Intensity:1e3,light1PositionZ:5,light2Color:16711680,light2Intensity:500,light2PositionZ:-20,colors:[255,2105376,16777215],materialParams:{metalness:.8,roughness:.5,clearcoat:1,clearcoatRoughness:.1},timeCoef:1,depthScale:1,tiltRotationX:.15,tiltRotationY:.15};class Be extends c{#C;#h=0;#A;#R;pointerPosition=new p;tilt=new p;#D=new p;#E=new u;#I=new r;constructor(e,t){const i={...je,...t};let s;"triangle"===i.type?(s=3,i.width=100/(i.n/2+.5),i.height=Math.sin(Math.PI/3)*i.width,i.radius=.5*i.width/Math.cos(Math.PI/6),i.nx=i.n,i.ny=Math.floor(3*i.n/5)):"square"===i.type?(s=4,i.width=100/i.n,i.height=100/i.n,i.radius=.5*i.width,i.nx=i.n,i.ny=Math.floor(2*i.n)):(s="hexagon"===i.type?6:16,i.radius=50/i.n,i.nx=i.n,i.ny=i.n);const n=function(e,t,i,s=0,n=0,o=6){const a=[];a.push(new r(t,-i/2));for(let e=0;e<o;e++){const c=t-s+Math.cos(e/(o-1)*Math.PI/2)*s,h=i/2-n+Math.sin(e/(o-1)*Math.PI/2)*n;a.push(new r(c,h))}a.push(new r(0,i/2));const c=new x(a,e);return c.translate(0,-i/2,0),c.rotateX(Math.PI/2),c}(s,i.radius,10*i.radius,.125*i.radius,.125*i.radius);super(n,new ke({...i.materialParams,side:v}),i.nx*i.ny),this.#C=e,this.config=i,this.#A=this.#O(),this.#R=new Float32Array(this.count).fill(0).map(()=>_e(2*Math.PI)),this.#L(),this.castShadow=!0,this.receiveShadow=!0,this.setColors(i.colors)}#L(){const e=new y(this.config.light1Color,this.config.light1Intensity);e.positionZ=this.config.light1PositionZ,e.castShadow=!0,e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,this.light1=e,this.#C.scene.add(this.light1);const t=new y(this.config.light2Color,this.config.light2Intensity);t.positionZ=this.config.light2PositionZ,this.light2=t,this.#C.scene.add(this.light2)}#O(){return"triangle"===this.config.type?function({nx:e,ny:t,width:i,height:s,radius:n}){const o=i/2,r=s,a=-e/2*o+o/2,c=-t/2*r+r/2;return Ve({nx:e,ny:t},(e,t)=>({x:a+e*o,y:c+t*r+.5*(t%2?-1:1)*(s-n)+e%2*(t%2?1:-1)*(2*n-s),rotZ:(e+t%2)%2*Math.PI/3}))}(this.config):"square"===this.config.type?function({nx:e,ny:t,width:i,height:s}){const n=i,o=s/2,r=-e/2*n+n/4,a=-t/2*o+o/2;return Ve({nx:e,ny:t},(e,t)=>({x:r+e*n+t%2/2*n,y:a+t*o,rotZ:0}))}(this.config):"hexagon"===this.config.type?function({nx:e,ny:t,radius:i}){const s=Math.cos(Math.PI/6)*i*2,n=1.5*i,o=-e/2*s+s/4,r=-t/2*n+n/2;return Ve({nx:e,ny:t},(e,t)=>({x:o+e*s+t%2/2*s,y:r+t*n,rotZ:0}))}(this.config):function({nx:e,ny:t,radius:i}){const s=2*i,n=Math.sin(Math.PI/3)*s,o=-e/2*s+s/4,r=-t/2*n+n/2;return Ve({nx:e,ny:t},(e,t)=>({x:o+e*s+t%2/2*s,y:r+t*n,rotZ:0}))}(this.config)}#F(){for(let e=0;e<this.config.nx;e++)for(let t=0;t<this.config.ny;t++){const i=e*this.config.ny+t,s=this.#A[i],n=this.#I.set(s.x,s.y).multiplyScalar(this.scale.x).sub(this.pointerPosition).length(),o=1-Ne(n,0,20*this.config.radius);this.#E.position.x=s.x,this.#E.position.y=s.y,this.#E.position.z=.5*(Math.cos(this.#R[i]+this.#h)-1)*this.config.radius*this.config.depthScale*o,this.#E.rotation.z=s.rotZ,this.#E.scale.set(1-this.config.padding,1-this.config.padding,1),this.#E.updateMatrix(),this.setMatrixAt(i,this.#E.matrix)}this.instanceMatrix.needsUpdate=!0}setColors(e){if(Array.isArray(e)&&e.length>1){const t=Ie(e);for(let e=0;e<this.count;e++)this.setColorAt(e,t.getColorAt(Math.random()));this.instanceColor.needsUpdate=!0}}resize(){this.#C.size.ratio>1?(this.scale.x=this.#C.size.wWidth/100*1.4,this.scale.y=this.scale.x):(this.scale.y=this.#C.size.wHeight/100*1.4,this.scale.x=this.scale.y)}update(e){this.#h+=e.delta*this.config.timeCoef,this.light1.position.set(this.pointerPosition.x,this.pointerPosition.y,this.light1.positionZ),this.light2.position.set(this.pointerPosition.x,this.pointerPosition.y,this.light2.positionZ),this.#D.lerp(this.tilt,.1),this.rotation.set(this.#D.x*this.config.tiltRotationX,this.#D.y*this.config.tiltRotationY,0),this.#F()}}function Ve({nx:e,ny:t},i){const s=new Array(e*t).fill(0);for(let n=0;n<e;n++)for(let e=0;e<t;e++){s[n*t+e]=i(n,e)}return s}function qe(e,t={}){const i=new ze({canvas:e,size:"parent",rendererOptions:{antialias:!0}});i.cameraMaxAspect=1,i.camera.position.z=100,i.updateWorldSize(),i.renderer.shadowMap.enabled=!0,i.renderer.shadowMap.type=w;const s=new Be(i,t);i.scene.add(s),s.resize();const n=new z,o=new S(new p(0,0,1),0),r=new p,a=Me({domElement:e});return a.onMove=()=>{n.setFromCamera(a.nPosition,i.camera),i.camera.getWorldDirection(o.normal),n.ray.intersectPlane(o,r),s.tilt.set(-a.nPosition.y,a.nPosition.x,0)},a.onLeave=()=>{r.set(0,0,0),s.tilt.set(0,0,0)},i.onBeforeRender=e=>{s.pointerPosition.lerp(r,.1),s.update(e)},i.onAfterResize=()=>{s.resize()},{three:i,grid:s,dispose(){a.dispose(),i.dispose()}}}const Ze={options:{},multisampling:!1,effects:[],passes:[]};class We{#T;#U;#k;#_;#N;constructor(e){const{renderer:t,camera:i,scene:s}=e,n={...Ze,...e.SETTINGS};var o;this.#T=new W(t,n.options),n.multisampling&&(this.#T.multisampling=Math.min(n.multisampling,t.capabilities.maxSamples)),this.#U=new H(s,i),this.#T.addPass(this.#U),this.#k=[],n.effects.forEach(e=>{const t=[...e.args];e.EffectClass===Y&&t.unshift(i);const s=new e.EffectClass(...t);this.#k.push(s)}),this.#k.length&&(this.#_=new G(i,...this.#k),this.#T.addPass(this.#_)),this.#N=[],n.passes.forEach(e=>{const t=[...e.args],i=new e.PassClass(...t);this.#N.push(i)}),this.#N.length&&this.#N.forEach(e=>this.#T.addPass(e)),this.render=this.render.bind(this),o=this,Object.defineProperty(o,"brightnessContrastEffect",{get(){return this.getEffect("BrightnessContrastEffect")}}),Object.defineProperty(o,"brightness",{get(){return this.brightnessContrastEffect?.uniforms.get("brightness").value},set(e){this.brightnessContrastEffect&&(this.brightnessContrastEffect.uniforms.get("brightness").value=e)}}),Object.defineProperty(o,"contrast",{get(){return this.brightnessContrastEffect?.uniforms.get("contrast").value},set(e){this.brightnessContrastEffect&&(this.brightnessContrastEffect.uniforms.get("contrast").value=e)}}),function(e){Object.defineProperty(e,"hueSaturationEffect",{get(){return this.getEffect("HueSaturationEffect")}}),Object.defineProperty(e,"hue",{get(){return this.hueSaturationEffect?.getHue()},set(e){this.hueSaturationEffect&&this.hueSaturationEffect.setHue(e)}}),Object.defineProperty(e,"saturation",{get(){return this.hueSaturationEffect?.uniforms.get("saturation").value},set(e){this.hueSaturationEffect&&(this.hueSaturationEffect.uniforms.get("saturation").value=e)}})}(this),function(e){Object.defineProperty(e,"depthOfFieldEffect",{get(){return this.getEffect("DepthOfFieldEffect")}}),Object.defineProperty(e,"bokehScale",{get(){return this.depthOfFieldEffect?.bokehScale},set(e){this.depthOfFieldEffect&&(this.depthOfFieldEffect.bokehScale=e)}}),Object.defineProperty(e,"focusDistance",{get(){return this.depthOfFieldEffect?.circleOfConfusionMaterial.focusDistance},set(e){this.depthOfFieldEffect&&(this.depthOfFieldEffect.circleOfConfusionMaterial.focusDistance=e)}}),Object.defineProperty(e,"focalLength",{get(){return this.depthOfFieldEffect?.circleOfConfusionMaterial.focalLength},set(e){this.depthOfFieldEffect&&(this.depthOfFieldEffect.circleOfConfusionMaterial.focalLength=e)}})}(this),function(e){Object.defineProperty(e,"bloomEffect",{get(){return this.getEffect("BloomEffect")}}),Object.defineProperty(e,"bloomIntensity",{get(){return this.bloomEffect?.intensity},set(e){this.bloomEffect&&(this.bloomEffect.intensity=e)}}),Object.defineProperty(e,"bloomRadius",{get(){return this.bloomEffect?.mipmapBlurPass.radius},set(e){this.bloomEffect&&(this.bloomEffect.mipmapBlurPass.radius=e)}}),Object.defineProperty(e,"bloomLuminanceThreshold",{get(){return this.bloomEffect?.luminanceMaterial.threshold},set(e){this.bloomEffect&&(this.bloomEffect.luminanceMaterial.threshold=e)}}),Object.defineProperty(e,"bloomLuminanceSmoothing",{get(){return this.bloomEffect?.luminanceMaterial.smoothing},set(e){this.bloomEffect&&(this.bloomEffect.luminanceMaterial.smoothing=e)}})}(this)}getEffect(e){const t=this.#k.find(t=>t.name===e);return t||console.error(`Postprocessing effect '${e}' not found`),t}setSize(e,t){this.#T.setSize(e,t)}render(){this.#T.render()}dispose(){this.#T.dispose()}}const{clamp:He,randFloatSpread:Ye,randInt:Ge,smoothstep:Xe}=o,Qe={type:"circle",n:50,padding:0,light1Color:16777215,light1Intensity:500,light1PositionZ:2,light2Color:255,light2Intensity:1e3,light2PositionZ:-5,planeColor:2105376,colors:[16777215,16777215],materialParams:{metalness:1,roughness:1},timeCoef:1,depthScale:.5,influenceRadius1:10,influenceRadius2:20};class $e extends c{#C;#h=0;#j;#B;#A;#R;pointerPosition=new p;tilt=new p;#E=new u;#I=new r;#V=new a;constructor(e,t){const i={...Qe,...t};let s;"triangle"===i.type?(s=3,i.width=100/(i.n/2+.5),i.height=Math.sin(Math.PI/3)*i.width,i.radius=.5*i.width/Math.cos(Math.PI/6),i.nx=i.n,i.ny=Math.floor(3*i.n/5)):"square"===i.type?(s=4,i.width=100/i.n,i.height=100/i.n,i.radius=.5*i.width,i.nx=i.n,i.ny=Math.floor(2*i.n)):(s="hexagon"===i.type?6:24,i.radius=50/i.n,i.nx=i.n,i.ny=i.n);const n=function(e,t,i,s=0,n=0,o=6){const a=[];a.push(new r(t,-i/2));for(let e=0;e<o;e++){const c=i/2-n+Math.sin((e+1)/o*Math.PI/2)*n,h=t-s+(1-(e+1)/o)*s;a.push(new r(h,c))}a.push(new r(0,i/2));const c=new x(a,e);c.translate(0,-i/2,0),c.rotateX(Math.PI/2);const h=c.attributes.uv.array,l=c.attributes.position.array,d=new p;for(let e=0;e<h.length/2;e+=1){d.fromArray(l,3*e);const i=d.x/t/2+.5,s=d.y/t/2+.5;h[2*e]=i,h[2*e+1]=s}return c}(s,i.radius,10*i.radius,.9*i.radius,.075*i.radius),o=(new m).load("/ps-buttons-black.webp"),c=new ke({...i.materialParams,flatShading:"circle"!==i.type,side:v,map:o,roughnessMap:o});super(n,c,i.nx*i.ny);const l=new Uint8Array(this.count).fill(0).map(()=>Ge(0,3));n.setAttribute("mapIndex",new P(l,1)),c.onBeforeCompile=e=>{e.vertexShader="\n        attribute float mapIndex;\n        varying float vMapIndex;\n        varying float vZ;\n      "+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","\n        vec4 mvPosition = vec4( transformed, 1.0 );\n        #ifdef USE_BATCHING\n          mvPosition = batchingMatrix * mvPosition;\n        #endif\n        #ifdef USE_INSTANCING\n          mvPosition = instanceMatrix * mvPosition;\n          vZ = mvPosition.z;\n        #endif\n        mvPosition = modelViewMatrix * mvPosition;\n        gl_Position = projectionMatrix * mvPosition;\n        vMapIndex = mapIndex;\n      "),e.fragmentShader="\n        varying float vMapIndex;\n        varying float vZ;\n      "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>","\n        float roughnessFactor = roughness;\n        #ifdef USE_ROUGHNESSMAP\n          vec2 ruv = vRoughnessMapUv;\n          ruv.x = (vMapIndex + vUv.x) / 4.0;\n          vec4 texelRoughness = texture2D( roughnessMap, ruv );\n          roughnessFactor = smoothstep(0.0, 0.5, vZ) * smoothstep(0.0, 1.0, (texelRoughness.r + texelRoughness.g + texelRoughness.b) / 3.0);\n          // roughnessFactor = (texelRoughness.r + texelRoughness.g + texelRoughness.b) / 3.0;\n        #endif\n      "),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","\n        #ifdef USE_MAP\n          vec2 uv = vUv;\n          uv.x = (vMapIndex + vUv.x) / 4.0;\n          vec4 sampledDiffuseColor = texture2D(map, uv);\n          // diffuseColor *= sampledDiffuseColor;\n          diffuseColor *= smoothstep(0.0, 0.5, vZ) * sampledDiffuseColor;\n          // diffuseColor.rgb *= sampledDiffuseColor.rgb * sampledDiffuseColor.a;\n          // diffuseColor.rgb = mix(diffuseColor.rgb, sampledDiffuseColor.rgb, sampledDiffuseColor.a);\n          // diffuseColor.rgb *= sampledDiffuseColor.rgb * sampledDiffuseColor.a;\n        #endif\n      ")},this.#C=e,this.config=i,this.#j=new Array(this.count).fill(0).map(()=>new a),this.#B=new Array(this.count).fill(0).map(()=>new a),this.#A=this.#O(),this.#R=new Float32Array(this.count).fill(0).map(()=>Ye(2*Math.PI)),this.#L(),this.castShadow=!0,this.receiveShadow=!0,this.setColors(i.colors),this.plane=new b(new h(100,100),new ke({color:i.planeColor,...i.materialParams,side:v})),this.plane.receiveShadow=!0,this.plane.position.z=.075*-i.radius,this.add(this.plane)}#L(){const e=new y(this.config.light1Color,this.config.light1Intensity);e.positionZ=this.config.light1PositionZ,e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.color2=e.color.clone(),e.intensity2=e.intensity,this.light1=e,this.add(this.light1);const t=new y(this.config.light2Color,this.config.light2Intensity);t.positionZ=this.config.light2PositionZ,t.color2=t.color.clone(),t.intensity2=t.intensity,this.light2=t,this.add(this.light2)}#O(){return"triangle"===this.config.type?function({nx:e,ny:t,width:i,height:s,radius:n}){const o=i/2,r=s,a=-e/2*o+o/2,c=-t/2*r+r/2;return Je({nx:e,ny:t},(e,t)=>({x:a+e*o,y:c+t*r+.5*(t%2?-1:1)*(s-n)+e%2*(t%2?1:-1)*(2*n-s),rotZ:(e+t%2)%2*Math.PI/3}))}(this.config):"square"===this.config.type?function({nx:e,ny:t,width:i,height:s}){const n=i,o=s/2,r=-e/2*n+n/4,a=-t/2*o+o/2;return Je({nx:e,ny:t},(e,t)=>({x:r+e*n+t%2/2*n,y:a+t*o,rotZ:0}))}(this.config):"hexagon"===this.config.type?function({nx:e,ny:t,radius:i}){const s=Math.cos(Math.PI/6)*i*2,n=1.5*i,o=-e/2*s+s/4,r=-t/2*n+n/2;return Je({nx:e,ny:t},(e,t)=>({x:o+e*s+t%2/2*s,y:r+t*n,rotZ:0}))}(this.config):function({nx:e,ny:t,radius:i}){const s=2*i,n=Math.sin(Math.PI/3)*s,o=-e/2*s+s/4,r=-t/2*n+n/2;return Je({nx:e,ny:t},(e,t)=>({x:o+e*s+t%2/2*s,y:r+t*n,rotZ:0}))}(this.config)}#F(){const{nx:e,ny:t,depthScale:i,padding:s,influenceRadius1:n,influenceRadius2:o}=this.config;for(let r=0;r<e;r++)for(let e=0;e<t;e++){const a=r*t+e,c=this.#A[a],h=this.#I.set(c.x,c.y).sub(this.pointerPosition).length(),l=(1-Xe(h,n,o))*Xe(h,0,n),d=.5*(Math.cos(this.#R[a]+this.#h)+1);this.#E.position.x=c.x,this.#E.position.y=c.y,this.#E.position.z=d*i*l,this.#E.rotation.z=c.rotZ;const u=1-s;this.#E.scale.set(u,u,1),this.#E.updateMatrix(),this.setMatrixAt(a,this.#E.matrix),this.#j[a].lerp(this.#B[a],.05),this.#V.copy(this.plane.material.color).lerp(this.#j[a],Xe(this.#E.position.z,0,i/2)),this.setColorAt(a,this.#V)}this.instanceMatrix.needsUpdate=!0,this.instanceColor.needsUpdate=!0}setColors(e){if(Array.isArray(e)&&e.length>1){const t=Ie(e);for(let e=0;e<this.count;e++)t.getColorAt(Math.random(),this.#B[e])}}resize(){this.#C.size.ratio>1?(this.scale.x=this.#C.size.wWidth/100*1.6,this.scale.y=this.scale.x):(this.scale.y=this.#C.size.wHeight/100*1.6,this.scale.x=this.scale.y)}update(e){this.#h+=e.delta*this.config.timeCoef,this.light1.color.lerp(this.light1.color2,.05),this.light1.intensity+=.05*(this.light1.intensity2-this.light1.intensity),this.light2.color.lerp(this.light2.color2,.05),this.light2.intensity+=.05*(this.light2.intensity2-this.light2.intensity),this.light1.position.set(this.pointerPosition.x,this.pointerPosition.y,this.light1.positionZ),this.light2.position.set(this.pointerPosition.x,this.pointerPosition.y,this.light2.positionZ),this.#F()}}function Je({nx:e,ny:t},i){const s=new Array(e*t).fill(0);for(let n=0;n<e;n++)for(let e=0;e<t;e++){s[n*t+e]=i(n,e)}return s}function Ke(e,t={}){const i=new ze({canvas:e,size:"parent",rendererOptions:{antialias:!0}});i.cameraMaxAspect=1,i.minPixelRatio=2,i.camera.position.z=30,i.camera.position.y=-25,i.camera.lookAt(0,0,-10),i.updateWorldSize(),i.renderer.shadowMap.enabled=!0,i.renderer.shadowMap.type=w;const s=new $e(i,t);i.scene.add(s);const n=new Z(i.camera,i.canvas);n.target.set(0,0,-10),n.enableDamping=!0,n.dampingFactor=.1;const o=new z,r=new p,a=(e=0,t=0)=>{o.setFromCamera({x:e,y:t},i.camera);const n=o.intersectObject(s.plane,!1);n.length>0&&(r.copy(n[0].point),r.x/=s.scale.x,r.y/=s.scale.y)},c=Me({domElement:e});return c.onMove=()=>{a(c.nPosition.x,c.nPosition.y)},c.onLeave=()=>{a()},i.onBeforeRender=e=>{n.update(),s.pointerPosition.lerp(r,.05),s.update(e)},i.onAfterResize=()=>{s.resize(),c.hover||(a(),s.pointerPosition.copy(r))},{three:i,grid:s,dispose(){c.dispose(),i.dispose()}}}let et,tt;async function it(e,t){let i;return i=e.endsWith(".hdr")?await function(e,t){tt||(tt=new Q);return tt.loadAsync(e,t)}(e,t):await function(e,t){et||(et=new m);return et.loadAsync(e,t)}(e,t),i}var st="varying vec2 vUv;void main(){vUv=uv;gl_Position=vec4(position,1.0);}";class nt{#q;#Z;#W;#H;#Y;#G;#X;#Q;#$;#J;#K;#ee;constructor({renderer:e,size:t=512}){this.#q=e,this.#Z=t,this.#W=t,this.#H={value:new r(1/this.#Z,1/this.#W).multiplyScalar(.5)},this.#Y={value:.995},this.#te(),this.#ie()}#te(){const e={type:A,format:C,depthBuffer:!1};this.#G=new M(this.#Z,this.#W,e),this.#X=new M(this.#Z,this.#W,e),this.#Q=new $}#ie(){this.#$=new R({uniforms:{tDiffuse:{value:null}},vertexShader:st,fragmentShader:"uniform sampler2D tDiffuse;varying vec2 vUv;void main(){gl_FragColor=texture2D(tDiffuse,vUv);}"}),this.#J=new R({uniforms:{tDiffuse:{value:null},delta:this.#H,attenuation:this.#Y},vertexShader:st,fragmentShader:"uniform sampler2D tDiffuse;uniform vec2 delta;uniform float attenuation;varying vec2 vUv;void main(){vec4 texel=texture2D(tDiffuse,vUv);vec2 dx=vec2(delta.x,0.0);vec2 dy=vec2(0.0,delta.y);float average=(texture2D(tDiffuse,vUv-dx).r+texture2D(tDiffuse,vUv-dy).r+texture2D(tDiffuse,vUv+dx).r+texture2D(tDiffuse,vUv+dy).r)*0.25;texel.g+=(average-texel.r)*2.0;texel.g*=attenuation;texel.r+=texel.g;gl_FragColor=texel;}"}),this.#K=new R({uniforms:{tDiffuse:{value:null},delta:this.#H},vertexShader:st,fragmentShader:"uniform sampler2D tDiffuse;uniform vec2 delta;varying vec2 vUv;void main(){vec4 texel=texture2D(tDiffuse,vUv);vec3 dx=vec3(delta.x,0.0,texture2D(tDiffuse,vec2(vUv.x+delta.x,vUv.y)).r-texel.r);vec3 dy=vec3(0.0,delta.y,texture2D(tDiffuse,vec2(vUv.x,vUv.y+delta.y)).r-texel.r);texel.ba=normalize(cross(dx,dy)).xy;gl_FragColor=texel;}"}),this.#ee=new R({uniforms:{tDiffuse:{value:null},center:new D(new r),radius:{value:.05},strength:{value:.5}},vertexShader:st,fragmentShader:"const float PI=3.1415926535897932384626433832795;uniform sampler2D tDiffuse;uniform vec2 center;uniform float radius;uniform float strength;varying vec2 vUv;void main(){vec4 texel=texture2D(tDiffuse,vUv);float drop=max(0.0,1.0-length(center*0.5+0.5-vUv)/radius);drop=0.5-cos(drop*PI)*0.5;texel.r+=drop*strength;gl_FragColor=texel;}"})}get texture(){return this.#G.texture}update(){this.#se(),this.#ne()}#se(){this.#J.uniforms.tDiffuse.value=this.#G.texture,this.#oe(this.#J,this.#X),this.#re()}#ne(){this.#K.uniforms.tDiffuse.value=this.#G.texture,this.#oe(this.#K,this.#X),this.#re()}addDrop(e,t,i,s){this.#ee.uniforms.tDiffuse.value=this.#G.texture,this.#ee.uniforms.center.value.set(e,t),this.#ee.uniforms.radius.value=i,this.#ee.uniforms.strength.value=s,this.#oe(this.#ee,this.#X),this.#re()}setAttenuation(e){this.#Y.value=e}#oe(e,t){this.#Q.material=e;const i=this.#q.getRenderTarget();this.#q.setRenderTarget(t),this.#Q.render(this.#q),this.#q.setRenderTarget(i)}#re(){const e=this.#G;this.#G=this.#X,this.#X=e}dispose(){this.#$.dispose(),this.#J.dispose(),this.#K.dispose(),this.#ee.dispose(),this.#G.dispose(),this.#X.dispose()}}class ot extends u{#ae;#ce;#he;#le;constructor({renderer:e}){super(),this.#ae=new nt({renderer:e}),this.#ce=new b(new h,new l),this.#ce.rotation.x=-Math.PI/2,this.#ce.position.y=-.1,this.#ce.visible=!1,this.add(this.#ce);const t=new f({color:"#ffffff",transmission:1,thickness:.25,metalness:.2,roughness:0});t.onBeforeCompile=e=>{e.uniforms.displacementMap={value:this.#ae.texture},e.uniforms.displacementScale={value:1},e.vertexShader="\n        uniform sampler2D displacementMap;\n        uniform float displacementScale;\n      "+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        vec3 transformed = vec3(position);\n        vec4 disp = texture2D(displacementMap, uv);\n        vNormal = normalMatrix * vec3(disp.b, disp.a, sqrt(1.0 - dot(disp.ba, disp.ba)));\n        transformed.z = displacementScale * disp.r;\n      ")},this.#he=new b(new h(1,1,256,256),t),this.#he.rotation.x=-Math.PI/2,this.add(this.#he);["attenuation","color","envMapIntensity","metalness","roughness","thickness","transmission"].forEach(e=>{Object.defineProperty(this,e,{get(){return this.#he.material[e]},set(t){"attenuation"===e?this.#ae.setAttenuation(t):"color"===e?this.#he.material.color.set(t):this.#he.material[e]=t}})})}update(){this.#ae.update()}addDrop(e,t,i,s){const n=this.#le>1?e:e*this.#le,o=this.#le>1?t/this.#le:t;this.#ae.addDrop(n,o,i,s)}setImage(e){this.#ce.material.map=e,this.#ce.material.needsUpdate=!0,this.#ce.visible=!!e,this.#de()}#de(){const e=this.#ce.material.map;if(e&&e.image){const t=e.image.width/e.image.height;this.#le<t?this.#ce.scale.set(t,1,1):this.#ce.scale.set(this.#le,this.#le/t,1)}}setEnvMap(e){this.#he.material.envMap=e,this.#he.material.needsUpdate=!0}setSize({wWidth:e,wHeight:t,ratio:i}){this.#le=i;const s=e>t?i*t:e/i;this.#he.scale.set(s,s,1),this.#de()}dispose(){this.#ae.dispose()}}const{randFloatSpread:rt,randFloat:at}=o;function ct(e,t={}){const i=new ze({canvas:e,size:"parent"});i.camera.fov=20,i.camera.position.y=1,i.camera.lookAt(0,0,0),i.updateWorldSize();const s=new ot({renderer:i.renderer});s.setSize(i.size),i.scene.add(s);const o={enable:!0,time:0,timeDelta:.5},r=Me({domElement:e});return r.onMove=()=>{s.addDrop(r.nPosition.x,r.nPosition.y,.025,.0025)},r.onClick=()=>{s.addDrop(r.nPosition.x,r.nPosition.y,.025,.05)},i.onBeforeRender=e=>{o.enable&&(o.time+=e.delta,o.time>o.timeDelta&&(s.addDrop(rt(2),rt(2),at(.01,.025),at(.001,.002)),o.time=0)),s.update()},i.onAfterResize=e=>{s.setSize(e)},{three:i,liquidPlane:s,async loadImage(e){if(e){const t=await it(e);t.colorSpace=n,s.setImage(t)}else s.setImage(null)},async loadEnvMap(e){if(e){const t=await it(e);t.mapping=E,s.setEnvMap(t)}else s.setEnvMap(null)},setRain(e){o.enable=e},setRainTime(e){o.timeDelta=e},dispose:()=>{r.dispose(),s.dispose(),i.dispose()}}}const ht={segments:128,colors:["#c7d8e2","#aa3b8c","#3c97ee"],points:[{x:0,y:5,z:20},{x:0,y:0,z:0},{x:0,y:-5,z:20}],closed:!1,offsetScale:{x:10,y:0,z:0},neonSize:5,timeScale:10},{randFloat:lt,randFloatSpread:dt}=o;function ut(e,i={}){const s=new ze({canvas:e,size:"parent"});s.maxPixelRatio=1,s.camera=new O;const n=function(e){const i={...ht,...e},s=2*i.segments,n={positions:new Array(i.segments).fill().map(()=>new p),colors:new Array(i.segments).fill().map(()=>new a),lengths:new Array(i.segments).fill().map(()=>lt(.005,.03)),timeOffsets:new Array(i.segments).fill().map(()=>lt(0,1)),velocities:new Array(i.segments).fill().map(()=>lt(.5,1))};let o;const c={width:0,height:0},l={value:0},d={value:new r},u={value:i.neonSize},m={value:new Array(s).fill().map(()=>new p)},f={value:n.colors.map(e=>e.clone())},g={uTime:l,uRatio:d,uNeonSize:u,uPoints:m,uColors:f};let v,y,x;const w=new p;return function(){v=new t,v.position.set(0,0,25),v.updateProjectionMatrix(),v.updateMatrixWorld(),y=new R({uniforms:g,defines:{NUM_SEGMENTS:i.segments,NUM_POINTS:s},vertexShader:"varying vec2 vUv;void main(){vUv=uv;gl_Position=vec4(position,1.0);}",fragmentShader:"uniform vec2 uRatio;uniform float uNeonSize;uniform vec3 uPoints[NUM_POINTS];uniform vec3 uColors[NUM_SEGMENTS];varying vec2 vUv;float sdSegment(in vec2 p,in vec2 a,in vec2 b){vec2 pa=p-a,ba=b-a;float h=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-ba*h);}void main(){vec2 pos=(vUv-0.5)*uRatio;vec3 col=vec3(0.0);for(int i=0;i<NUM_SEGMENTS;i++){vec3 p1=uPoints[i*2];vec3 p2=uPoints[i*2+1];if((p1.z<-1.0||p1.z>1.0)||(p2.z<-1.0||p2.z>1.0))continue;float dist=sdSegment(pos,p1.xy,p2.xy);float glow=uNeonSize/dist;col+=glow*uColors[i];}gl_FragColor=vec4(col,1.0);}"}),x=new b(new h(2,2),y),o=new I([]),S(i.points),o.closed=i.closed;for(let e=0;e<i.segments;e++)n.positions[e].set(dt(1),dt(1),dt(1));z(i.colors)}(),Object.assign(x,{update:function(e){let t,s;l.value+=e.delta*i.timeScale;for(let e=0;e<i.segments;e++){const r=n.positions[e],a=m.value[2*e],c=m.value[2*e+1];t=(n.timeOffsets[e]+l.value*n.velocities[e]*.025)%1,s=o.closed?(t+n.lengths[e])%1:Math.min(1,t+n.lengths[e]),o.getPoint(t,a),o.getPoint(s,c),w.x=r.x*i.offsetScale.x,w.y=r.y*i.offsetScale.y,w.z=r.z*i.offsetScale.z,a.add(w),a.project(v),c.add(w),c.project(v),o.closed||f.value[e].copy(n.colors[e]).multiplyScalar(Math.sin(Math.PI*t))}},setColors:z,setCurvePoints:S,setCurveClosed:function(e){o.closed=e},setCurveOffsetScale:function(e){i.offsetScale=e},setNeonSize:function(e){i.neonSize=e,c.width>=c.height?u.value=i.neonSize/c.width:u.value=i.neonSize/c.height},setVelocity:function(e){i.timeScale=e},setSize:function(e,t){c.width=e,c.height=t,e>=t?(d.value.set(1,t/e),u.value=i.neonSize/e):(d.value.set(e/t,1),u.value=i.neonSize/t)}}),x;function z(e){const t=Ie(e);for(let e=0;e<i.segments;e++)n.colors[e].copy(t.getColorAt(lt(0,1))),f.value[e].copy(n.colors[e]);const s=e.map(e=>{const t=new a;return t.set(e),t.getHexString()});console.log("debugColors",s)}function S(e){o.points=e.map(e=>e.isVector3?e:new p(e.x,e.y,e.z))}}(i);return n.setSize(s.size.width,s.size.height),s.scene.add(n),s.onBeforeRender=e=>{n.update(e)},s.onAfterResize=e=>{n.setSize(e.width,e.height)},{three:s,neon:n,setColors:n.setColors,setCurvePoints:n.setCurvePoints,setCurveClosed:n.setCurveClosed,setCurveOffsetScale:n.setCurveOffsetScale,setNeonSize:n.setNeonSize,setVelocity:n.setVelocity,dispose:s.dispose.bind(s)}}const{randFloat:pt,randFloatSpread:mt}=o,ft=new p,gt=new p,vt=new p,yt=new p,xt=new p,wt=new p,zt=new p,St=new p,Pt=new p,bt=new p;let Mt=class{constructor(e){this.config=e,this.positionData=new Float32Array(3*e.count).fill(0),this.velocityData=new Float32Array(3*e.count).fill(0),this.sizeData=new Float32Array(e.count).fill(1),this.center=new p,this.#ue(),this.setSizes()}#ue(){const{config:e,positionData:t}=this;this.center.toArray(t,0);for(let i=1;i<e.count;i++){const s=3*i;t[s]=mt(2*e.maxX),t[s+1]=mt(2*e.maxY),t[s+2]=mt(2*e.maxZ)}}setSizes(){const{config:e,sizeData:t}=this;t[0]=e.size0;for(let i=1;i<e.count;i++)t[i]=pt(e.minSize,e.maxSize)}update(e){const{config:t,center:i,positionData:s,sizeData:n,velocityData:o}=this;let r=0;t.controlSphere0&&(r=1,ft.fromArray(s,0),ft.lerp(i,.1).toArray(s,0),yt.set(0,0,0).toArray(o,0));for(let i=r;i<t.count;i++){const r=3*i;gt.fromArray(s,r),xt.fromArray(o,r),xt.y-=e.delta*t.gravity*n[i],xt.multiplyScalar(t.friction),xt.clampLength(0,t.maxVelocity),gt.add(xt),gt.toArray(s,r),xt.toArray(o,r)}for(let e=r;e<t.count;e++){const i=3*e;gt.fromArray(s,i),xt.fromArray(o,i);const r=n[e];for(let a=e+1;a<t.count;a++){const e=3*a;vt.fromArray(s,e),wt.fromArray(o,e);const t=n[a];zt.copy(vt).sub(gt);const c=zt.length(),h=r+t;if(c<h){const t=h-c;St.copy(zt).normalize().multiplyScalar(.5*t),Pt.copy(St).multiplyScalar(Math.max(xt.length(),1)),bt.copy(St).multiplyScalar(Math.max(wt.length(),1)),gt.sub(St),xt.sub(Pt),gt.toArray(s,i),xt.toArray(o,i),vt.add(St),wt.add(bt),vt.toArray(s,e),wt.toArray(o,e)}}if(t.controlSphere0){zt.copy(ft).sub(gt);const e=zt.length(),t=r+n[0];if(e<t){const i=t-e;St.copy(zt).normalize().multiplyScalar(i),Pt.copy(St).multiplyScalar(Math.max(xt.length(),2)),gt.sub(St),xt.sub(Pt)}}Math.abs(gt.x)+r>t.maxX&&(gt.x=Math.sign(gt.x)*(t.maxX-r),xt.x=-xt.x*t.wallBounce),0===t.gravity?Math.abs(gt.y)+r>t.maxY&&(gt.y=Math.sign(gt.y)*(t.maxY-r),xt.y=-xt.y*t.wallBounce):gt.y-r<-t.maxY&&(gt.y=-t.maxY+r,xt.y=-xt.y*t.wallBounce);const a=Math.max(t.maxZ,t.maxSize);Math.abs(gt.z)+r>a&&(gt.z=Math.sign(gt.z)*(t.maxZ-r),xt.z=-xt.z*t.wallBounce),gt.toArray(s,i),xt.toArray(o,i)}}};const Ct={count:200,colors:[255,0,16777215],ambientColor:16777215,ambientIntensity:1,lightIntensity:200,materialParams:{metalness:.5,roughness:.5,clearcoat:1,clearcoatRoughness:.15},minSize:.5,maxSize:1,size0:1,gravity:.5,friction:.9975,wallBounce:.95,maxVelocity:.15,maxX:5,maxY:5,maxZ:2,controlSphere0:!1},At=new u;let Rt=class extends c{constructor(e,t={}){const i={...Ct,...t},s=new J,n=new L(e,.04).fromScene(s).texture,o=new F,r=new ke({envMap:n,...i.materialParams});r.envMapRotation.x=-Math.PI/2,super(o,r,i.count),this.config=i,this.physics=new Mt(i),this.#L(),this.setColors(i.colors)}#L(){this.ambientLight=new T(this.config.ambientColor,this.config.ambientIntensity),this.add(this.ambientLight),this.light=new y(this.config.colors[0],this.config.lightIntensity),this.add(this.light)}setColors(e){if(Array.isArray(e)&&e.length>1){const t=Ie(e);for(let e=0;e<this.count;e++)this.setColorAt(e,t.getColorAt(e/this.count)),0===e&&this.light.color.copy(t.getColorAt(e/this.count));this.instanceColor.needsUpdate=!0}}update(e){this.physics.update(e);for(let e=0;e<this.count;e++)At.position.fromArray(this.physics.positionData,3*e),At.scale.setScalar(this.physics.sizeData[e]),At.updateMatrix(),this.setMatrixAt(e,At.matrix),0===e&&this.light.position.copy(At.position);this.instanceMatrix.needsUpdate=!0}};function Dt(e,t={}){const i=new ze({canvas:e,size:"parent",rendererOptions:{antialias:!0,alpha:!0}});let s;i.renderer.toneMapping=U,i.camera.position.set(0,0,20),i.camera.lookAt(0,0,0),i.cameraMaxAspect=1.5,i.resize(),h(t);const n=new z,o=new S(new p(0,0,1),0),r=new p;let a=!1;const c=Me({domElement:e,onMove(){n.setFromCamera(c.nPosition,i.camera),i.camera.getWorldDirection(o.normal),n.ray.intersectPlane(o,r),s.physics.center.copy(r),s.config.controlSphere0=!0},onLeave(){s.config.controlSphere0=!1}});function h(e){s&&(i.clear(),i.scene.remove(s)),s=new Rt(i.renderer,e),i.scene.add(s)}return i.onBeforeRender=e=>{a||s.update(e)},i.onAfterResize=e=>{s.config.maxX=e.wWidth/2,s.config.maxY=e.wHeight/2},{three:i,get spheres(){return s},setCount(e){h({...s.config,count:e})},togglePause(){a=!a},dispose(){c.dispose(),i.dispose()}}}const{randFloat:Et,randFloatSpread:It}=o,Ot=new p,Lt=new p,Ft=new p,Tt=new p,Ut=new p,kt=new p,_t=new p,Nt=new p,jt=new p;class Bt{constructor(e){this.config=e,this.positionData=new Float32Array(3*e.count).fill(0),this.velocityData=new Float32Array(3*e.count).fill(0),this.sizeData=new Float32Array(e.count).fill(1),this.center=new p,this.#ue(),this.setSizes()}#ue(){const{config:e,positionData:t}=this;this.center.toArray(t,0);for(let i=1;i<e.count;i++){const e=3*i;t[e]=It(10),t[e+1]=It(10),t[e+2]=It(10)}}setSizes(){const{config:e,sizeData:t}=this;t[0]=e.size0;for(let i=1;i<e.count;i++)t[i]=Et(e.minSize,e.maxSize)}update(e){const{config:t,center:i,positionData:s,sizeData:n,velocityData:o}=this;Ot.fromArray(s,0),Ot.lerp(i,.1).toArray(s,0);for(let i=1;i<t.count;i++){const r=3*i;Lt.fromArray(s,r),Tt.fromArray(o,r);const a=n[i];kt.copy(Ot).sub(Lt),Tt.add(kt.normalize().multiplyScalar(e.delta*t.attraction*a)),Tt.multiplyScalar(t.friction),Tt.clampLength(0,t.maxVelocity),Lt.add(Tt),Lt.toArray(s,r),Tt.toArray(o,r)}for(let e=1;e<t.count;e++){const i=3*e;Lt.fromArray(s,i),Tt.fromArray(o,i);const r=n[e];for(let i=e+1;i<t.count;i++){const e=3*i;Ft.fromArray(s,e),Ut.fromArray(o,e);const t=n[i];kt.copy(Ft).sub(Lt);const a=kt.length(),c=r+t;if(a<c){const t=c-a;_t.copy(kt).normalize().multiplyScalar(.5*t),Nt.copy(_t).multiplyScalar(Math.max(Tt.length(),1)),jt.copy(_t).multiplyScalar(Math.max(Ut.length(),1)),Lt.sub(_t),Tt.sub(Nt),Ft.add(_t),Ut.add(jt),Ft.toArray(s,e),Ut.toArray(o,e)}}kt.copy(Ot).sub(Lt);const a=kt.length(),c=r+n[0];if(a<c){const e=c-a;_t.copy(kt).normalize().multiplyScalar(e),Nt.copy(_t).multiplyScalar(Math.max(Tt.length(),2)),Lt.sub(_t),Tt.sub(Nt)}Lt.toArray(s,i),Tt.toArray(o,i)}}}const Vt={count:200,colors:[16711680,0,16777215],pointLightIntensity:150,directionalLightColor:16777215,directionalLightIntensity:5,materialParams:{metalness:.5,roughness:.5,clearcoat:1,clearcoatRoughness:.15},minSize:.25,maxSize:1,size0:3,attraction:.15,friction:.9975,maxVelocity:.15},qt=new u;let Zt=class extends c{constructor(e,t={}){const i={...Vt,...t};super(new F,new ke(i.materialParams),i.count),this.castShadow=!0,this.receiveShadow=!0,this.config=i,this.physics=new Bt(i),this.#L(),this.setColors(i.colors)}#L(){this.pointLight=new y(this.config.colors[0],this.config.pointLightIntensity),this.add(this.pointLight);const e=this.directionalLight=new k(this.config.directionalLightColor,this.config.directionalLightIntensity);e.position.set(20,20,20),e.target.position.set(0,0,0),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.shadow.camera.far=70,e.shadow.camera.left=-17.5,e.shadow.camera.right=17.5,e.shadow.camera.top=17.5,e.shadow.camera.bottom=-17.5,this.add(e),this.add(e.target)}setColors(e){if(Array.isArray(e)&&e.length>1){const t=Ie(e);for(let e=0;e<this.count;e++)this.setColorAt(e,t.getColorAt(e/this.count)),0===e&&this.pointLight.color.copy(t.getColorAt(e/this.count));this.instanceColor.needsUpdate=!0}}update(e){this.physics.update(e);for(let e=0;e<this.count;e++)qt.position.fromArray(this.physics.positionData,3*e),qt.scale.setScalar(this.physics.sizeData[e]),qt.updateMatrix(),this.setMatrixAt(e,qt.matrix),0===e&&this.pointLight.position.copy(qt.position);this.instanceMatrix.needsUpdate=!0}};function Wt(e,t={}){const i=new ze({canvas:e,size:"parent",rendererOptions:{antialias:!0,alpha:!0}});i.renderer.shadowMap.enabled=!0,i.renderer.shadowMap.type=w,i.renderer.toneMapping=U,i.camera.position.set(0,0,30),i.camera.lookAt(0,0,0),i.cameraMaxAspect=1.5,i.resize();const s=new J,n=new L(i.renderer,.04).fromScene(s).texture;let o;d(t);const r=new z,a=new S(new p(0,0,1),0),c=new p;let h=!1;const l=Me({domElement:e,onMove(){r.setFromCamera(l.nPosition,i.camera),i.camera.getWorldDirection(a.normal),r.ray.intersectPlane(a,c),o.physics.center.copy(c)},onLeave(){o.physics.center.set(0,0,0)}});function d(e){o&&(i.clear(),i.scene.remove(o)),o=new Zt(i.renderer,e);const t=e.materialParams||{};void 0===t.envMap&&(o.material.envMap=n),void 0===t.envMapIntensity&&(o.material.envMapIntensity=.25),o.material.envMapRotation.x=-Math.PI/2,i.scene.add(o)}return i.onBeforeRender=e=>{h||o.update(e)},i.onAfterResize=e=>{o.config.maxX=e.wWidth/2,o.config.maxY=e.wHeight/2},{three:i,get spheres(){return o},setCount(e){d({...o.config,count:e})},togglePause(){h=!h},dispose(){l.dispose(),i.dispose()}}}const{randFloat:Ht,randFloatSpread:Yt}=o,Gt={count:5e4,colors:["#a70267","#f10c49","#fb6b41","#f6d86b","#339194"],map:null,timeScale:1};class Xt extends u{#pe;#me;constructor(e,t={}){super(),this.config={...Gt,...t},this.#pe={uTime:{value:0}},this.#fe()}#fe(){this.geometry=new _;const e=new Float32Array(3*this.config.count),t=new Float32Array(this.config.count),i=new Float32Array(3*this.config.count),s=new p;for(let t=0;t<this.config.count;t++)s.set(Yt(200),Yt(200),Yt(300)),s.toArray(e,3*t);this.geometry.setAttribute("position",new N(e,3)),this.geometry.setAttribute("size2",new N(t,1)),this.geometry.setAttribute("color",new N(i,3)),this.setSizes(1,5),this.setColors(this.config.colors),this.material=new j({blending:d,depthTest:!1,depthWrite:!1,sizeAttenuation:!0,transparent:!0,vertexColors:!0}),this.config.map&&this.loadMap(this.config.map),this.material.onBeforeCompile=e=>{Object.assign(e.uniforms,this.#pe),e.vertexShader="\n        uniform float uTime;\n        attribute float size2;\n        varying float vAlpha;\n      "+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        vec3 transformed = vec3(position);\n        transformed.z = -150. + mod(position.z + uTime, 300.);\n        vAlpha = smoothstep(-150.0, -125.0, transformed.z) * smoothstep(150.0, 125.0, transformed.z);\n      "),e.vertexShader=e.vertexShader.replace("gl_PointSize = size;","gl_PointSize = size2;"),e.fragmentShader="\n        varying float vAlpha;\n      "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","\n        float alpha = vAlpha;\n        #ifndef USE_MAP\n          float dist = length(gl_PointCoord - 0.5);\n          if (dist > 0.5) discard;\n          alpha *= smoothstep(0.5, 0.0, dist);\n        #endif\n        diffuseColor.rgb *= vColor;\n        diffuseColor.a = alpha;\n      ")},this.particles=new B(this.geometry,this.material),this.add(this.particles)}loadMap(e){null===e?(this.material.map=null,this.material.needsUpdate=!0):(this.#me||(this.#me=new m),this.material.map=this.#me.load(e),this.material.needsUpdate=!0)}setSizes(e,t){const i=this.geometry.attributes.size2.array;for(let s=0;s<this.config.count;s++)i[s]=Ht(e,t);this.geometry.attributes.size2.needsUpdate=!0}setColors(e){const t=this.geometry.attributes.color.array,i=new a;for(let s=0;s<this.config.count;s++)i.set(e[Math.floor(Math.random()*e.length)]),i.toArray(t,3*s);this.geometry.attributes.color.needsUpdate=!0}update(e){this.#pe.uTime.value+=e.delta*this.config.timeScale*10}}var Qt={uniforms:{tDiffuse:{value:null},center:{value:new r(.5,.5)},strength:{value:0}},vertexShader:"\n  varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform vec2 center;\n    uniform float strength;\n    varying vec2 vUv;\n\n    float random(vec3 scale, float seed) {\n      /* use the fragment position for a different seed per-pixel */\n      return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n    }\n    \n    void main() {\n      vec4 color = vec4(0.0);\n      float total = 0.0;\n      vec2 toCenter = center - vUv;\n      \n      /* randomize the lookup values to hide the fixed number of samples */\n      float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n      \n      for (float t = 0.0; t <= 40.0; t++) {\n        float percent = (t + offset) / 40.0;\n        float weight = 4.0 * (percent - percent * percent);\n        vec4 texel = texture2D(tDiffuse, vUv + toCenter * percent * strength);\n\n        /* switch to pre-multiplied alpha to correctly blur transparent images */\n        texel.rgb *= texel.a;\n\n        color += texel * weight;\n        total += weight;\n      }\n\n      gl_FragColor = color / total;\n\n      /* switch back from pre-multiplied alpha */\n      gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n    }\n  "};const{lerp:$t}=o;function Jt(e,t={}){const i=new ze({canvas:e,size:"parent",rendererOptions:{antialias:!0}});i.camera.position.z=100,i.resize(),i.renderer.toneMapping=U;let s=1,n=1;const o=new ee(i.scene,i.camera),a=new te(new r(i.size.width/2,i.size.height/2));a.radius=0,a.strength=.5,a.threshold=0;const c=new ie(Qt),h=new se,l=new K(i.renderer);l.addPass(o),l.addPass(a),l.addPass(c),l.addPass(h),i.postprocessing=l;const d=new Xt(i,t);i.scene.add(d);const u=Me({domElement:e});return i.onBeforeRender=e=>{const t=$t(d.position.x,5*-u.nPosition.x,.02),i=$t(d.position.y,5*-u.nPosition.y,.02);d.position.set(t,i,0),s+=.02*(n-s),c.uniforms.strength.value=.5*s/50,d.config.timeScale=s,d.update(e)},i.onAfterResize=e=>{l.setSize(e.width,e.height)},{three:i,bloomPass:a,particles:d,get velocity(){return s},set velocity(e){n=Math.min(Math.max(e,0),50)},dispose(){u.dispose(),i.dispose()}}}const Kt={colors:[255,16711680],shaderPoints:16,curvePoints:64,curveLerp1:.5,curveLerp2:.5,radius1:5,radius2:5,sleepRadiusX:50,sleepRadiusY:50,sleepTimeScale1:2,sleepTimeScale2:2};function ei(e,t={}){const i=new ze({canvas:e,size:"parent",rendererOptions:{alpha:!0}});i.camera=new O;const s=function(e){const t={...Kt,...e},i={width:0,height:0},s=Ie(t.colors),n=new Array(t.curvePoints).fill(0).map(()=>new r),o=new V(n),c=new r;let l=0,d=0;const u={value:new r},p={value:new r},m={value:new Array(t.shaderPoints).fill(0).map(()=>new r)},f={value:new a(16711935)},g={uRatio:u,uNeonSize:p,uPoints:m,uColor:f};let v,y;return function(){const e=new h(2,2);v=new R({uniforms:g,defines:{SHADER_POINTS:t.shaderPoints},vertexShader:"varying vec2 vUv;void main(){vUv=uv;gl_Position=vec4(position,1.0);}",fragmentShader:"float sdBezier(vec2 pos,vec2 A,vec2 B,vec2 C){vec2 a=B-A;vec2 b=A-2.0*B+C;vec2 c=a*2.0;vec2 d=A-pos;float kk=1.0/dot(b,b);float kx=kk*dot(a,b);float ky=kk*(2.0*dot(a,a)+dot(d,b))/3.0;float kz=kk*dot(d,a);float res=0.0;float p=ky-kx*kx;float p3=p*p*p;float q=kx*(2.0*kx*kx-3.0*ky)+kz;float h=q*q+4.0*p3;if(h>=0.0){h=sqrt(h);vec2 x=(vec2(h,-h)-q)/2.0;vec2 uv=sign(x)*pow(abs(x),vec2(1.0/3.0));float t=uv.x+uv.y-kx;t=clamp(t,0.0,1.0);vec2 qos=d+(c+b*t)*t;res=length(qos);}else{float z=sqrt(-p);float v=acos(q/(p*z*2.0))/3.0;float m=cos(v);float n=sin(v)*1.732050808;vec3 t=vec3(m+m,-n-m,n-m)*z-kx;t=clamp(t,0.0,1.0);vec2 qos=d+(c+b*t.x)*t.x;float dis=dot(qos,qos);res=dis;qos=d+(c+b*t.y)*t.y;dis=dot(qos,qos);res=min(res,dis);qos=d+(c+b*t.z)*t.z;dis=dot(qos,qos);res=min(res,dis);res=sqrt(res);}return res;}uniform vec2 uRatio;uniform vec2 uNeonSize;uniform vec2 uPoints[SHADER_POINTS];uniform vec3 uColor;varying vec2 vUv;void main(){vec2 pos=(vUv-0.5)*uRatio;vec2 c=(uPoints[0]+uPoints[1])/2.0;vec2 c_prev;float dist=10000.0;for(int i=0;i<SHADER_POINTS-1;i++){c_prev=c;c=(uPoints[i]+uPoints[i+1])/2.0;dist=min(dist,sdBezier(pos,c_prev,uPoints[i],c));}dist=max(0.0,dist);float glow=uNeonSize.y/dist;vec3 col=vec3(0.0);col+=10.0*vec3(smoothstep(uNeonSize.x,0.0,dist));col+=glow*uColor;col=1.0-exp(-col);col=pow(col,vec3(0.5));gl_FragColor=vec4(col,glow);}"}),y=new b(e,v)}(),Object.assign(y,{config:t,update:function({time:e,pointer:r}){if(r.hover)c.x=.5*r.nPosition.x*u.value.x,c.y=.5*r.nPosition.y*u.value.y,d=Math.min(o.points[0].distanceTo(c)/.05,1),l+=.05*(d-l),s.getColorAt(l,f.value);else{const n=e.elapsed*t.sleepTimeScale1,o=e.elapsed*t.sleepTimeScale2,r=Math.cos(n),a=Math.sin(o),h=t.sleepRadiusX/(i.width/u.value.x),l=t.sleepRadiusY/(i.height/u.value.y);c.x=h*r,c.y=l*a,s.getColorAt(.5+.5*Math.cos(e.elapsed),f.value)}o.points[0].lerp(c,t.curveLerp1);for(let e=1;e<t.curvePoints;e++)n[e].lerp(n[e-1],t.curveLerp2);for(let e=0;e<t.shaderPoints;e++)o.getPoint(e/(t.shaderPoints-1),m.value[e])},setColors:function(e){t.colors=e,s.setColors(e)},setSize:function(e,t){i.width=e,i.height=t,x()},updateUniforms:x}),y;function x(){p.value.set(t.radius1,t.radius2),i.width>=i.height?(u.value.set(1,i.height/i.width),p.value.multiplyScalar(1/i.width)):(u.value.set(i.width/i.height,1),p.value.multiplyScalar(1/i.height))}}(t);s.setSize(i.size.width,i.size.height),i.scene.add(s);const n=Me({domElement:i.canvas});return i.onBeforeRender=e=>{s.update({time:e,pointer:n})},i.onAfterResize=e=>{s.setSize(e.width,e.height)},{three:i,neon:s,neonConfig:s.config,setColors:s.setColors,dispose:()=>{n.dispose(),i.dispose()}}}const{randFloat:ti,randFloatSpread:ii}=o,si={gpgpuSize:512,size:5,colors:[65280,255],color:16711680,decay:.0025,noiseCoordScale:.5,noiseIntensity:.001,noiseTimeCoef:.1};class ni extends u{#C;#q;#me;#ge;uniforms;#ve;#ye;#xe;constructor(e,t={}){super(),this.config={...si,...t},this.#C=e,this.#q=e.renderer,this.#ge={uTime:{value:0},uPointerPosition:{value:new p},uPointerDirection:{value:new p},uDecay:{value:this.config.decay},uNoiseCoordScale:{value:this.config.noiseCoordScale},uNoiseIntensity:{value:this.config.noiseIntensity},uColor:{value:new a(this.config.color)},uPointSize:{value:this.config.size}},this.uniforms={tPosition:{value:null},tVelocity:{value:null},...this.#ge},this.#we(),this.#fe()}#we(){this.#ve=new ne(this.config.gpgpuSize,this.config.gpgpuSize,this.#q),this.#q.capabilities.isWebGL2||this.#ve.setDataType(q),this.#ye=this.#ve.createTexture(),this.#xe=this.#ve.createTexture(),this.#ze(this.#ye,this.#xe),this.velocityVariable=this.#ve.addVariable("textureVelocity",`\n      ${Oe}\n      uniform float uTime;\n      uniform float uNoiseCoordScale;\n      uniform float uNoiseIntensity;\n      void main() {\n        vec2 uv = gl_FragCoord.xy / resolution.xy;\n        vec4 pos = texture2D(texturePosition, uv);\n        vec4 vel = texture2D(textureVelocity, uv);\n\n        if (pos.w < 0.0) {\n          vel.x = 0.0; vel.y = 0.0; vel.z = 0.0;\n        } else {\n          vec3 grad;\n          psrdnoise(pos.xyz * uNoiseCoordScale, vec3(0.0), uTime, grad);\n          vel.xyz += grad * uNoiseIntensity * pos.w;\n        }\n        gl_FragColor = vel;\n      }\n    `,this.#xe),this.positionVariable=this.#ve.addVariable("texturePosition","\n      uniform float uDecay;\n      uniform vec3 uPointerPosition;\n      void main() {\n        vec2 uv = gl_FragCoord.xy / resolution.xy;\n        vec4 pos = texture2D(texturePosition, uv);\n        vec4 vel = texture2D(textureVelocity, uv);\n        if (pos.w < 0.0) { pos.w = vel.w; }\n        pos.w -= uDecay;\n        if (pos.w <= 0.0) {\n          pos.xyz = uPointerPosition;\n        } else {\n          pos.xyz += vel.xyz;\n        }\n        gl_FragColor = pos;\n      }\n    ",this.#ye),this.#ve.setVariableDependencies(this.velocityVariable,[this.positionVariable,this.velocityVariable]),this.#ve.setVariableDependencies(this.positionVariable,[this.positionVariable,this.velocityVariable]),this.#ve.uniforms={...this.#ge},Object.assign(this.velocityVariable.material.uniforms,this.#ve.uniforms),Object.assign(this.positionVariable.material.uniforms,this.#ve.uniforms);const e=this.#ve.init();if(null!==e)throw new Error(e)}#ze(e,t){const i=new p,s=e.image.data,n=t.image.data;for(let e=0;e<this.config.gpgpuSize;e++)for(let t=0;t<this.config.gpgpuSize;t++){const o=4*(e+t*this.config.gpgpuSize);i.x=e/this.config.gpgpuSize-.5,i.y=t/this.config.gpgpuSize-.5,i.toArray(s,o),s[o+3]=ti(.1,1),i.set(0,0,0).toArray(n,o),n[o+3]=ti(.1,1)}}#fe(){this.geometry=function(e){const t=new _,i=new Float32Array(e*e*3).fill(0),s=new Float32Array(e*e*2),n=new Float32Array(e*e*3);for(let t=0;t<e;t++)for(let i=0;i<e;i++){const n=t*e+i;s[2*n]=t/e,s[2*n+1]=i/e}return t.setAttribute("position",new N(i,3)),t.setAttribute("positionUv",new N(s,2)),t.setAttribute("color",new N(n,3)),t}(this.config.gpgpuSize),this.setColors(this.config.colors),this.material=new j({blending:d,depthTest:!1,depthWrite:!1,size:this.config.size,sizeAttenuation:!1,transparent:!0,vertexColors:!0}),this.config.map&&this.loadMap(this.config.map),this.material.onBeforeCompile=e=>{Object.assign(e.uniforms,this.uniforms),e.vertexShader="\n        uniform sampler2D tPosition;\n        uniform sampler2D tVelocity;\n        uniform float uPointSize;\n        attribute vec2 positionUv;\n        varying float alpha;\n      "+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        vec4 pos = texture2D(tPosition, positionUv);\n        vec4 vel = texture2D(tVelocity, positionUv);\n        vec3 transformed = pos.xyz;\n        alpha = pos.w;\n      "),e.vertexShader=e.vertexShader.replace("gl_PointSize = size;","\n        gl_PointSize = uPointSize * pos.w * (vel.w + 0.5);\n      "),e.fragmentShader="\n        uniform vec3 uColor;\n        varying float alpha;\n      "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","\n        #ifndef USE_MAP\n          float dist = length(gl_PointCoord - 0.5);\n          if (dist > 0.5) discard;\n        #endif\n        diffuseColor *= vec4(mix(vColor, uColor, alpha), alpha);\n      ")},this.particles=new B(this.geometry,this.material),this.add(this.particles)}loadMap(e){null===e?(this.material.map=null,this.material.needsUpdate=!0):(this.#me||(this.#me=new m),this.material.map=this.#me.load(e),this.material.needsUpdate=!0)}setColors(e){const t=this.geometry.attributes.color.array,i=Ie(e),s=new a;for(let e=0;e<this.config.gpgpuSize*this.config.gpgpuSize;e++)i.getColorAt(Math.random(),s),s.toArray(t,3*e);this.geometry.attributes.color.needsUpdate=!0}update(e){this.uniforms.uTime.value+=e.delta*this.config.noiseTimeCoef,this.#ve.compute(),this.uniforms.tPosition.value=this.#ve.getCurrentRenderTarget(this.positionVariable).texture,this.uniforms.tVelocity.value=this.#ve.getCurrentRenderTarget(this.velocityVariable).texture}dispose(){this.#ve.dispose()}}function oi(e,t={}){const i=new ze({canvas:e,size:"parent",rendererOptions:{alpha:!0,antialias:!1,stencil:!1,depth:!1}});i.camera.position.z=50,i.updateWorldSize(),i.postprocessing=new We({renderer:i.renderer,camera:i.camera,scene:i.scene,multisampling:3,SETTINGS:{effects:[{EffectClass:X,args:[{luminanceThreshold:.5,luminanceSmoothing:.1,intensity:1}]}]}});const s=new ni(i,t);i.scene.add(s);const n=new z,o=new S(new p(0,0,1),0),r=new p,a=Me({domElement:e});return a.onMove=()=>{n.setFromCamera(a.nPosition,i.camera),i.camera.getWorldDirection(o.normal),n.ray.intersectPlane(o,r),s.uniforms.uPointerPosition.value.copy(r)},a.onClick=()=>{},i.onBeforeRender=e=>{s.update(e)},i.onAfterResize=e=>{},{three:i,particles:s,dispose(){a.dispose(),s.dispose(),i.dispose()}}}class ri{#e;canvas;camera;cameraMinAspect;cameraMaxAspect;cameraFov;maxPixelRatio;minPixelRatio;scene;renderer;size={width:0,height:0,wWidth:0,wHeight:0,ratio:0,pixelRatio:0};render=this.#i;onBeforeRender=()=>{};onAfterRender=()=>{};onAfterResize=()=>{};#s=!1;#n=!1;isDisposed=!1;#o;#r;#a;#c=new oe;#h={elapsed:0,delta:0};constructor(e){this.#e={...e},this.#d(),this.#u(),this.#p(),this.resize(),this.#m()}#d(){this.camera=new re,this.cameraFov=this.camera.fov}#u(){this.scene=new ae}#p(){this.#e.canvas?this.canvas=this.#e.canvas:this.#e.id?this.canvas=document.getElementById(this.#e.id):console.error("Three: Missing canvas or id parameter"),this.canvas.style.display="block";const e={canvas:this.canvas,...this.#e.rendererOptions??{}};this.renderer=new ce(e)}#m(){this.#e.size instanceof Object||(window.addEventListener("resize",this.#f.bind(this)),"parent"===this.#e.size&&(this.#r=new ResizeObserver(this.#f.bind(this)),this.#r.observe(this.canvas.parentNode))),this.#o=new IntersectionObserver(this.#g.bind(this),{root:null,rootMargin:"0px",threshold:0}),this.#o.observe(this.canvas),document.addEventListener("visibilitychange",this.#v.bind(this))}#y(){window.removeEventListener("resize",this.#f.bind(this)),this.#r?.disconnect(),this.#o?.disconnect(),document.removeEventListener("visibilitychange",this.#v.bind(this))}#g(e){this.#s=e[0].isIntersecting,this.#s?this.#x():this.#w()}#v(e){this.#s&&(document.hidden?this.#w():this.#x())}#f(){this.#a&&clearTimeout(this.#a),this.#a=setTimeout(this.resize.bind(this),100)}resize(){let e,t;this.#e.size instanceof Object?(e=this.#e.size.width,t=this.#e.size.height):"parent"===this.#e.size&&this.canvas.parentNode?(e=this.canvas.parentNode.offsetWidth,t=this.canvas.parentNode.offsetHeight):(e=window.innerWidth,t=window.innerHeight),this.size.width=e,this.size.height=t,this.size.ratio=e/t,this.#z(),this.#S(),this.onAfterResize(this.size)}#z(){this.camera.aspect=this.size.width/this.size.height,this.camera.isPerspectiveCamera&&this.cameraFov&&(this.cameraMinAspect&&this.camera.aspect<this.cameraMinAspect?this.#P(this.cameraMinAspect):this.cameraMaxAspect&&this.camera.aspect>this.cameraMaxAspect?this.#P(this.cameraMaxAspect):this.camera.fov=this.cameraFov),this.camera.updateProjectionMatrix(),this.updateWorldSize()}#P(e){const t=Math.tan(he.degToRad(this.cameraFov/2))/(this.camera.aspect/e);this.camera.fov=2*he.radToDeg(Math.atan(t))}updateWorldSize(){if(this.camera.isPerspectiveCamera){const e=this.camera.fov*Math.PI/180;this.size.wHeight=2*Math.tan(e/2)*this.camera.position.length(),this.size.wWidth=this.size.wHeight*this.camera.aspect}else this.camera.isOrthographicCamera&&(this.size.wHeight=this.camera.top-this.camera.bottom,this.size.wWidth=this.camera.right-this.camera.left)}#S(){this.renderer.setSize(this.size.width,this.size.height);let e=window.devicePixelRatio;this.maxPixelRatio&&e>this.maxPixelRatio?e=this.maxPixelRatio:this.minPixelRatio&&e<this.minPixelRatio&&(e=this.minPixelRatio),this.renderer.setPixelRatio(e),this.size.pixelRatio=e}#x(){this.#n||(this.#n=!0,this.#c.start(),this.renderer.setAnimationLoop(()=>{this.#h.delta=this.#c.getDelta(),this.#h.elapsed+=this.#h.delta,this.onBeforeRender(this.#h),this.render(),this.onAfterRender(this.#h)}))}#w(){this.#n&&(this.renderer.setAnimationLoop(null),this.#n=!1,this.#c.stop())}#i(){this.renderer.render(this.scene,this.camera)}clear(){this.scene.traverse(e=>{e.isMesh&&"object"==typeof e.material&&(Object.keys(e.material).forEach(t=>{const i=e.material[t];null!==i&&"object"==typeof i&&"function"==typeof i.dispose&&i.dispose()}),e.material.dispose(),e.geometry.dispose())}),this.scene.clear()}dispose(){console.log("dispose"),this.#y(),this.#w(),this.clear(),this.renderer.dispose(),this.isDisposed=!0}}function ai(e,t,i,s){let n=[0,0,0];n=[e[0]+hi(e,[.3333333333333333,.3333333333333333,.3333333333333333]),e[1]+hi(e,[.3333333333333333,.3333333333333333,.3333333333333333]),e[2]+hi(e,[.3333333333333333,.3333333333333333,.3333333333333333])];let o=li(n);const r=di(n),a=ui([r[0],r[1],r[0]],[r[1],r[2],r[2]]),c=[1-a[0],1-a[1],1-a[2]],h=[c[2],a[0],a[1]],l=[c[0],c[1],a[2]],d=function(e,t){if(e.length)return t.length?e.map(function(e,i){return Math.min(e,t[i])}):e.map(function(e,i){return Math.min(e,t)});return Math.min(e,t)}(h,l),u=pi(h,l);let p=[o[0]+d[0],o[1]+d[1],o[2]+d[2]],m=[o[0]+u[0],o[1]+u[1],o[2]+u[2]],f=[o[0]+1,o[1]+1,o[2]+1],g=[0,0,0],v=[0,0,0],y=[0,0,0],x=[0,0,0];g=[o[0]-hi(o,[.16666666666666666,.16666666666666666,.16666666666666666]),o[1]-hi(o,[.16666666666666666,.16666666666666666,.16666666666666666]),o[2]-hi(o,[.16666666666666666,.16666666666666666,.16666666666666666])],v=[p[0]-hi(p,[.16666666666666666,.16666666666666666,.16666666666666666]),p[1]-hi(p,[.16666666666666666,.16666666666666666,.16666666666666666]),p[2]-hi(p,[.16666666666666666,.16666666666666666,.16666666666666666])],y=[m[0]-hi(m,[.16666666666666666,.16666666666666666,.16666666666666666]),m[1]-hi(m,[.16666666666666666,.16666666666666666,.16666666666666666]),m[2]-hi(m,[.16666666666666666,.16666666666666666,.16666666666666666])],x=[f[0]-hi(f,[.16666666666666666,.16666666666666666,.16666666666666666]),f[1]-hi(f,[.16666666666666666,.16666666666666666,.16666666666666666]),f[2]-hi(f,[.16666666666666666,.16666666666666666,.16666666666666666])];const w=[e[0]-g[0],e[1]-g[1],e[2]-g[2]],z=[e[0]-v[0],e[1]-v[1],e[2]-v[2]],S=[e[0]-y[0],e[1]-y[1],e[2]-y[2]],P=[e[0]-x[0],e[1]-x[1],e[2]-x[2]];if(function(e){return e.some(function(e){return e})}(function(e,t){if(e.length){const i=Array(e.length);for(let s=0;s<e.length;s++)i[s]=e[s]>t[s];return i}return e>t}(t,[0,0,0]))){let e=[g[0],v[0],y[0],x[0]],i=[g[1],v[1],y[1],x[1]],s=[g[2],v[2],y[2],x[2]];t[0]>0&&(e=ci(e,t[0])),t[1]>0&&(i=ci(i,t[1])),t[2]>0&&(s=ci(s,t[2])),g=[e[0],i[0],s[0]],v=[e[1],i[1],s[1]],y=[e[2],i[2],s[2]],x=[e[3],i[3],s[3]],o=[g[0]+hi(g,[.3333333333333333,.3333333333333333,.3333333333333333]),g[1]+hi(g,[.3333333333333333,.3333333333333333,.3333333333333333]),g[2]+hi(g,[.3333333333333333,.3333333333333333,.3333333333333333])],p=[v[0]+hi(v,[.3333333333333333,.3333333333333333,.3333333333333333]),v[1]+hi(v,[.3333333333333333,.3333333333333333,.3333333333333333]),v[2]+hi(v,[.3333333333333333,.3333333333333333,.3333333333333333])],m=[y[0]+hi(y,[.3333333333333333,.3333333333333333,.3333333333333333]),y[1]+hi(y,[.3333333333333333,.3333333333333333,.3333333333333333]),y[2]+hi(y,[.3333333333333333,.3333333333333333,.3333333333333333])],f=[x[0]+hi(x,[.3333333333333333,.3333333333333333,.3333333333333333]),x[1]+hi(x,[.3333333333333333,.3333333333333333,.3333333333333333]),x[2]+hi(x,[.3333333333333333,.3333333333333333,.3333333333333333])],o=li([o[0]+.5,o[1]+.5,o[2]+.5]),p=li([p[0]+.5,p[1]+.5,p[2]+.5]),m=li([m[0]+.5,m[1]+.5,m[2]+.5]),f=li([f[0]+.5,f[1]+.5,f[2]+.5])}const b=yi(mi.add([],yi(mi.add([],yi([o[2],p[2],m[2],f[2]]),[o[1],p[1],m[1],f[1]])),[o[0],p[0],m[0],f[0]])),M=[3.883222077*b[0],3.883222077*b[1],3.883222077*b[2],3.883222077*b[3]],C=[-.006920415*b[0]+.996539792,-.006920415*b[1]+.996539792,-.006920415*b[2]+.996539792,-.006920415*b[3]+.996539792];let A=[.108705628*b[0],.108705628*b[1],.108705628*b[2],.108705628*b[3]];const R=fi(M),D=gi(M),E=vi([1-C[0]*C[0],1-C[1]*C[1],1-C[2]*C[2],1-C[3]*C[3]]);let I=[0,0,0,0],O=[0,0,0,0],L=[0,0,0,0];const F=D,T=[-R[0],-R[1],-R[2],-R[3]],U=[0,0,0,0],k=[C[0]*T[0],C[1]*T[1],C[2]*T[2],C[3]*T[3]],_=[-C[0]*F[0],-C[1]*F[1],-C[2]*F[2],-C[3]*F[3]],N=E;A=[A[0]+i,A[1]+i,A[2]+i,A[3]+i];const j=gi(A),B=fi(A);I=[B[0]*k[0]+j[0]*F[0],B[1]*k[1]+j[1]*F[1],B[2]*k[2]+j[2]*F[2],B[3]*k[3]+j[3]*F[3]],O=[B[0]*_[0]+j[0]*T[0],B[1]*_[1]+j[1]*T[1],B[2]*_[2]+j[2]*T[2],B[3]*_[3]+j[3]*T[3]],L=[B[0]*N[0]+j[0]*U[0],B[1]*N[1]+j[1]*U[1],B[2]*N[2]+j[2]*U[2],B[3]*N[3]+j[3]*U[3]];const V=[I[0],O[0],L[0]],q=[I[1],O[1],L[1]],Z=[I[2],O[2],L[2]],W=[I[3],O[3],L[3]];let H=[hi(w,w),hi(z,z),hi(S,S),hi(P,P)].map(function(e){return.5-e});H=pi(H,0);const Y=[H[0]*H[0],H[1]*H[1],H[2]*H[2],H[3]*H[3]],G=[Y[0]*H[0],Y[1]*H[1],Y[2]*H[2],Y[3]*H[3]],X=[hi(V,w),hi(q,z),hi(Z,S),hi(W,P)],Q=hi(G,X),$=[-6*Y[0]*X[0],-6*Y[1]*X[1],-6*Y[2]*X[2],-6*Y[3]*X[3]],J=[G[0]*V[0]+$[0]*w[0],G[0]*V[1]+$[0]*w[1],G[0]*V[2]+$[0]*w[2]],K=[G[1]*q[0]+$[1]*z[0],G[1]*q[1]+$[1]*z[1],G[1]*q[2]+$[1]*z[2]],ee=[G[2]*Z[0]+$[2]*S[0],G[2]*Z[1]+$[2]*S[1],G[2]*Z[2]+$[2]*S[2]],te=[G[3]*W[0]+$[3]*P[0],G[3]*W[1]+$[3]*P[1],G[3]*W[2]+$[3]*P[2]];return s[0]=39.5*(J[0]+K[0]+ee[0]+te[0]),s[1]=39.5*(J[1]+K[1]+ee[1]+te[1]),s[2]=39.5*(J[2]+K[2]+ee[2]+te[2]),39.5*Q}function ci(e,t){return e.length?t.length?e.map(function(e,i){return 0===e||0===t[i]?0:e%t[i]}):e.map(function(e,i){return 0===e||0===t?0:e%t}):e%t}function hi(e,t){let i=0;for(let s=0;s<e.length;s++)i+=e[s]*t[s];return i}function li(e){return e.length?e.map(li):Math.floor(e)}function di(e){return e.length?e.map(di):e-Math.floor(e)}function ui(e,t){return t||e?t.length?e.length?t.map(function(t,i){return ui(e[i],t)}):t.map(function(t,i){return ui(e,t)}):t<e?0:1:0}function pi(e,t){return e.length?t.length?e.map(function(e,i){return Math.max(e,t[i])}):e.map(function(e,i){return Math.max(e,t)}):Math.max(e,t)}function mi(e,t,i,s){return null==e&&(e=0),null==t&&(t=e),null==i&&(i=t),null==s&&(s=i),[e,t,i,s]}function fi(e){return e.length?e.map(fi):Math.cos(e)}function gi(e){return e.length?e.map(gi):Math.sin(e)}function vi(e){return e.length?e.map(vi):Math.sqrt(e)}function yi(e){const t=ci(e,289);return ci([(34*t[0]+10)*t[0],(34*t[1]+10)*t[1],(34*t[2]+10)*t[2],(34*t[3]+10)*t[3]],289)}mi.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e};const xi=new Float32Array(3),wi=new Float32Array(3),zi=new Float32Array(3);class Si extends le{timeDelta=100*Math.random();constructor(e,t){const i=e.tubularSegments||64,s=e.radius||.5,n=e.radialSegments||8,o=e.capSegments||4;super(new Pi(i,s,n,o),t),this.curve=this.geometry.curve,this.points=this.curve.points,this.to=new de,this.geometry.update()}lerpTo(e,t=.1,i=.05,s){zi[0]=.01*e.x+.04*s+this.timeDelta,zi[1]=.01*e.y+.048*s+this.timeDelta,zi[2]=.01*e.z+.06*s+this.timeDelta,ai(zi,xi,2*s,wi),this.to.copy(e),this.to.x+=wi[0]*i,this.to.y+=wi[1]*i,this.to.z+=wi[2]*i,this.points[0].lerp(this.to,t);for(let e=1;e<this.points.length;e++)this.points[e].lerp(this.points[e-1],t);this.geometry.update()}}class Pi extends ue{constructor(e=64,t=1,i=8){const s=new Array(e+1).fill(0).map(()=>new de);s.forEach((t,i)=>{t.z=-i/e*2});const n=new pe(s);super(n,e,t,i,!1),this.curve=n}update(){!function(e){const{curve:t}=e,{tubularSegments:i,radius:s,radialSegments:n}=e.parameters,o=t.computeFrenetFrames(t.points.length,!1);e.tangents=o.tangents,e.normals=o.normals,e.binormals=o.binormals;const r=e.getAttribute("position"),a=e.getAttribute("normal"),c=new de,h=new de;for(let e=0;e<=i;e++)l(e);function l(e){const l=e/i,d=Math.sin(l*Math.PI)*s;h.copy(t.points[e]);let u=e*(n+1);const p=o.normals[e],m=o.binormals[e];for(let e=0;e<=n;e++){const t=e/n*Math.PI*2,i=Math.sin(t),s=-Math.cos(t);c.x=s*p.x+i*m.x,c.y=s*p.y+i*m.y,c.z=s*p.z+i*m.z,c.normalize(),r.setXYZ(u,h.x+d*c.x,h.y+d*c.y,h.z+d*c.z),a.setXYZ(u,c.x,c.y,c.z),u++}}r.needsUpdate=!0,a.needsUpdate=!0}(this)}}const bi={count:16,colors:[16777215*Math.random(),16777215*Math.random(),16777215*Math.random()],minRadius:.005,maxRadius:.05,minTubularSegments:32,maxTubularSegments:128,material:{metalness:1,roughness:.25},lights:{intensity:200,colors:[16777215*Math.random(),16777215*Math.random(),16777215*Math.random(),16777215*Math.random()]},lerp:.5,noise:.05};class Mi extends ae{target=new de;lights=[];tubes=[];constructor(e){super(),this.options={...bi,...e},this.init()}init(){this.initLights(),this.initTubes()}initLights(){for(let e=0;e<4;e++){const t=new me(this.options.lights.colors[e],this.options.lights.intensity);t.position.set(e<2?-5:5,e%2==0?-5:5,5),this.lights.push(t),this.add(t)}}initTubes(){for(let e=0;e<this.options.count;e++){const t=he.randFloat(this.options.minRadius,this.options.maxRadius),i=he.randInt(this.options.minTubularSegments,this.options.maxTubularSegments),s=new fe(this.options.material);this.tubes[e]=new Si({radius:t,tubularSegments:i},s),this.add(this.tubes[e])}this.setColors(this.options.colors)}setColors(e){const t=Ie(e);this.tubes.forEach((e,i)=>{e.material.color.set(t.getColorAt(i/(this.tubes.length-1)))})}setLightsColors(e){for(let t=0;t<4;t++)this.lights[t].color.set(e[t])}setLightsIntensity(e){this.lights.forEach(t=>{t.intensity=e})}update(e){for(let t=0;t<this.options.count;t++)this.tubes[t].lerpTo(this.target,this.options.lerp,this.options.noise,e.elapsed)}}const Ci={bloom:{threshold:0,strength:1.5,radius:.5},tubes:{},sleepRadiusX:300,sleepRadiusY:150,sleepTimeScale1:1,sleepTimeScale2:2};function Ai(e,t={}){const i={...Ci,...t},s=new ri({canvas:e,size:"parent",rendererOptions:{alpha:!0,antialias:!1}});s.camera.position.set(0,0,5),s.camera.lookAt(0,0,0),s.cameraMaxAspect=1.5,s.minPixelRatio=2,s.maxPixelRatio=2,s.resize();const n=new Mi(i.tubes);let o;if(s.scene=n,i.bloom){const e=new ge(s.renderer),t=xe(s.scene,s.camera).getTextureNode("output");o=we(t,i.bloom.strength,i.bloom.radius,i.bloom.threshold),e.outputNode=t.add(o),s.render=e.render.bind(e)}const r=new ve,a=new ye(new de(0,0,1),0),c=new de,h=Me({domElement:e,onMove(){r.setFromCamera(h.nPosition,s.camera),s.camera.getWorldDirection(a.normal),r.ray.intersectPlane(a,c)}});return s.onBeforeRender=function(e){if(h.hover)n.target.copy(c);else{const t=s.size.wWidth/s.size.width,o=i.sleepRadiusX*t,r=i.sleepRadiusY*t;n.target.x=o*Math.cos(e.elapsed*i.sleepTimeScale1),n.target.y=r*Math.sin(e.elapsed*i.sleepTimeScale2)}n.update(e)},{three:s,options:i,tubes:n,get bloomPass(){return o},dispose(){h.dispose(),s.dispose()}}}export{Ue as Bokeh1Background,qe as Grid1Background,Ke as Grid2Background,ct as Liquid1Background,ut as Neon1Background,ei as Neon1Cursor,oi as Particles1Cursor,Dt as Spheres1Background,Wt as Spheres2Background,Jt as Starfield1Background,ze as Three,Ai as Tubes1Cursor};
